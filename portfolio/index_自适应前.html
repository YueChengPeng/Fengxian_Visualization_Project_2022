<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <script type="text/javascript" src="js/lib/jquery.min.js"></script>
    <script type="text/javascript" src="js/scrollmagic/uncompressed/ScrollMagic.js"></script>
    <script type="text/javascript" src="js/scrollmagic/uncompressed/plugins/debug.addIndicators.js"></script>
    <script type="text/javascript" src="js/lib/greensock/TweenMax.min.js"></script>
    <script type="text/javascript" src="js/scrollmagic/uncompressed/plugins/animation.gsap.js"></script>
    <script src="https://use.typekit.net/nlq1kdt.js"></script>

    <script src="https://d3js.org/d3.v6.js"></script>
    <script src="https://unpkg.com/d3-simple-slider"></script>


    <!-- BOOTSTRAP5 最新编译并压缩的 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <!-- 最新编译的 JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://use.typekit.net/upe5kqr.css"> <!--字体-->

    <style>
        html {
            font-size: 24px; /*rem（font size of the root element）是指相对于根元素的字体大小的单位*/
        }

        body {
            background: #141414;
        }

        @font-face {
            font-family: impact;
            src: url("font/Impact.ttf");
        }

        @font-face {
            font-family: hand;
            src: url("font/Hand_Of_Sean.ttf");
        }

        .h1title {
            font-family: impact;
            font-size: 4rem;
        }

        .h2title {
            font-family: impact;
            font-size: 2rem;
        }

        .h3title {
            font-family: impact;
            font-size: 1.2rem;
        }

        .h4title {
            font-family: impact;
            font-size: 1rem;
        }

        .fontGrad45 {
            background-image: -webkit-linear-gradient(45deg, #da7d1e, #ffc000);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .cataGrad {
            background: linear-gradient(45deg, #da7d1e, #ffc000);
            border-radius: 10px;
        }


        .fontWhite {
            color: rgba(255, 255, 255, 0.84);
        }


        .fontWhite_light {
            color: rgba(255, 255, 255, 0.75);

        }

        .fontHighlight {
            color: rgba(255, 192, 0, 0.9);
        }

        .normalContent {
            font-family: noto-sans, sans-serif;
            font-weight: 300;
            font-style: normal;
            font-size: .7rem;
            color: rgba(255, 255, 255, 0.71);
        }

        .handContent {
            font-family: hand;
            font-weight: 300;
            font-style: normal;
            font-size: 1rem;
            color: rgba(255, 192, 0, 0.9);
        }

        .captionContent {
            font-family: noto-sans, sans-serif;
            font-weight: 200;
            font-style: normal;
            font-size: .4rem;
            color: rgba(255, 255, 255, 0.71);
        }

        .normalContentBigword {
            font-family: noto-sans, sans-serif;
            font-weight: 500;
            font-style: normal;
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.71);
        }

        .normalContentBigwordHighlight {
            font-family: noto-sans, sans-serif;
            font-weight: 500;
            font-style: normal;
            font-size: 1rem;
            color: rgba(255, 192, 0, 0.9);
        }

        .bigNumbers {
            font-family: noto-sans, sans-serif;
            font-weight: 600;
            font-style: normal;
            font-size: 1.2rem;
            color: rgba(255, 192, 0, 0.9);
        }

        .normalContentHighlightLink {
            font-family: noto-sans, sans-serif;
            font-weight: 600;
            font-style: normal;
            font-size: .8rem;
            text-decoration: underline;
            color: rgba(255, 192, 0, 0.9);
        }


        .normalContentHighlight {
            font-family: noto-sans, sans-serif;
            font-weight: 500;
            font-style: normal;
            font-size: .7rem;
            color: rgba(255, 192, 0, 0.9);
        }

        .buttonSelected {
            background-color: #282828;
            border-radius: 4rem;

            border: 1px rgba(68, 68, 68, 0) solid;
            padding: 10px 30px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
        }

        .buttonUnSelected {
            background-color: rgba(40, 40, 40, 0);
            opacity: .4;
            border-radius: 4rem;

            border: 1px rgba(68, 68, 68, 0.9) solid;
            padding: 10px 30px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
        }

        .questionSelected {
            background-color: #282828;
            border-radius: 4rem;

            border: 1px rgba(68, 68, 68, 0) solid;
            padding: 10px 18px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
        }

        .questionUnSelected {
            background-color: rgba(40, 40, 40, 0);
            opacity: .4;
            border-radius: 4rem;

            border: 1px rgba(68, 68, 68, 0.9) solid;
            padding: 10px 18px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
        }

        .windCard {
            margin-left: 20rem;
            margin-right: 20rem;
            height: fit-content;
            background-color: rgba(24, 24, 24, 0.5);
            border-radius: 25px;
            margin-bottom: 10rem;
            padding-top: 2rem;
            padding-bottom: 2rem;
            -webkit-box-shadow: rgba(192, 187, 180, 0.2) 0px 0px 50px;
            -moz-box-shadow: rgba(192, 187, 180, 0.2) 0px 0px 50px;
            box-shadow: rgba(192, 187, 180, 0.2) 0px 0px 50px;
        }

        .postCard {

            height: fit-content;
            background-color: rgba(46, 46, 46, 0.5);
            padding: 3rem;
            margin-top: 2rem;
            margin-bottom: 4rem;
        }

        .postName {
            font-family: noto-sans, sans-serif;
            font-weight: 700;
            font-style: normal;
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.84);
        }

        .slider text {
            fill: rgba(255, 255, 255, .4);
        }



    </style>

</head>
<body>

<!--目录-->
<div id="catalog"
     style="opacity: 0; position:fixed; top: 0rem; left: 0rem; width: 20%; height: 80%; padding: 1rem; margin-left: 1rem; margin-top: 1rem;z-index: 1">
    <div id="catlogRect" style="position: absolute; width: 8rem; height: 1.2rem; left: 10px; top: 22px" class="cataGrad"></div>
    <p id="designWithDataCataTxt" class="normalContent cataTxt" style="opacity: .3; cursor: pointer" onclick="cataJumpTo(1)">DESIGN WITH DATA</p>
    <p id="designQuestionsCataTxt" class="normalContent cataTxt" style="opacity: .3; cursor: pointer" onclick="cataJumpTo(2)">DESIGN QUESTIONS</p>
    <p id="dataCollectionCataTxt" class="normalContent cataTxt" style="opacity: .3; cursor: pointer" onclick="cataJumpTo(3)">DATA COLLECTION</p>
    <p id="designProcessCataTxt" class="normalContent cataTxt" style="opacity: .3; cursor: pointer" onclick="cataJumpTo(4)">DESIGN PROCESS</p>
    <p id="otherChallengesCataTxt" class="normalContent cataTxt" style="opacity: .3; cursor: pointer" onclick="cataJumpTo(5)">OTHER CHALLENGES</p>
    <p id="reflectionCataTxt" class="normalContent cataTxt" style="opacity: .3; cursor: pointer" onclick="cataJumpTo(6)">REFLECTION</p>

</div>

<!--video和遮挡的矩形-->
<div style="position:absolute;left: 50%; top: 50%; transform: translate(-50%, -50%); /* 50%为自身尺寸的一半 */
    -webkit-transform: translate(-50%, -50%); z-index: -1; ">
    <div style="position:absolute; transform: translate(0px, -1px); height: 20%; width: 100%; background-image: -webkit-linear-gradient(90deg, rgba(20,20,20,0), #141414)"></div>
    <div style="position:absolute; transform: translate(0px, -1px); height: 20%; width: 100%; background-image: -webkit-linear-gradient(90deg, rgba(20,20,20,0), #141414)"></div>
    <div style="position:absolute; transform: translate(0px, 400%); height: 20%; width: 100%; background-image: -webkit-linear-gradient(90deg, #141414, rgba(20,20,20,0))"></div>
    <div style="position:absolute; transform: translate(0px, 400%); height: 20%; width: 100%; background-image: -webkit-linear-gradient(90deg, #141414, rgba(20,20,20,0))"></div>

    <div style="position:absolute; height: 100%; width: 100%; background-color: #141414; opacity: .3"></div>

    <video id="coverVideo" src="video/coverVideo.mp4" style="height: 90vh;" autoplay="autoplay" muted="muted"
           loop="loop"></video>
</div>

<!--封面文字-->
<div style="margin-left: 5rem; margin-right: 5rem; height:100vh; display: flex; flex-direction: row; justify-content: space-between;">
    <div style="height:100%; display: flex; flex-direction: column; justify-content: center">
        <span class="h1title fontWhite">A BLOW OF</span>
        <span class="h1title fontGrad45">ANGRY WIND</span>
        <span class="h1title fontWhite">BROKE CHAINS</span>
        <span class="h1title fontWhite"> ON A MOTHER</span>
    </div>
    <div style="height:100%; display: flex; flex-direction: column; justify-content: center">
        <div style="display: flex; flex-direction: column">
            <span id="coverNoViews" class="h1title fontGrad45" align="right">0</span>
            <span class="h1title fontWhite" align="right" style="font-size: 1rem; opacity: .6">views</span>
            <br>
        </div>

        <div style="display: flex; flex-direction: column">
            <span id="coverNoDiscussions" class="h1title fontGrad45" align="right">0</span>
            <span class="h1title fontWhite" align="right" style="font-size: 1rem; opacity: .6">discussions</span>
            <br>
        </div>

        <div style="display: flex; flex-direction: column">
            <span id="coverNoOriginals" class="h1title fontGrad45" align="right">0</span>
            <span class="h1title fontWhite" align="right" style="font-size: 1rem; opacity: .6">original users</span>
            <br>
        </div>

    </div>
</div>

<div style="margin-left: 20rem; margin-right: 20rem; margin-top: 10rem; margin-bottom: 5rem">

    <p class="normalContent" style="">
        In Jan 27, 2022, a TikTok video of a Chinese mother of eight locked up in a worn-out village shed with a chain
        around her neck went viral and sparked widespread outrage.
    </p>

    <p class="normalContent">
        While authorities released a series of conflicting reports and kept official media silent, a blow of <span class="normalContentHighlight">ANGRY WIND</span> swept through the social media.
    </p>

</div>


<div style="margin-left: 10rem; margin-right: 10rem;">

    <div class="postCard" style="margin-right: 20rem; margin-left: 2rem; border-radius:0px 25px 25px 25px;">
        <div style="display: flex; align-items: flex-end;">
            <p class="postName">@Fengxian County Publicity Department</p>
        </div>
        <p class="normalContent" style="opacity: .7; margin: 0rem">After the preliminary investigation verification, the
            mother got married with Dong in August 1998, and <span class="normalContentHighlight">there is no human trafficking</span>.
            Family members and neighbors reported that Yang often beat children and elderly people for no reason.
            According to the diagnosis of medical institutions, Yang is suffering from mental illness. At present, she
            has been treated and her family has been further assisted to ensure a warm Spring Festival. The details are
            under further investigation and verification.</p>
    </div>

    <div class="postCard" style="margin-left: 20rem; margin-right: 2rem; border-radius:25px 25px 0px 25px;">
        <div style="display: flex; align-items: flex-end;">
            <p class="postName" style="margin-bottom: 0.8rem;">@Xiaoshe Sun</p>
            <p class="normalContent" style="margin-left: 1rem">53K followers</p>
        </div>
        <p class="normalContent" style="opacity: .7; margin: 0rem">Official reports from Fengxian has already overdrawn
            the credibility of local government. Interest groups are worried that when the “radish” is pull up by public
            opinions, the “mud” of sloth administration, concealing and lying, together with the blood and tears of
            local women and children will be revealed. <span class="normalContentHighlight">We need a higher-level investigation team to overthrow the local interest network from the outside and bring fair back.</span>
        </p>
    </div>

</div>

<!--quote-->
<div style="margin-left: 20rem; margin-right: 20rem; margin-top: 10rem; margin-bottom: 15rem">
    <p class="fontGrad45" style="font-family: impact; font-size: 18rem; position: absolute; margin: 0px; margin-top: -10rem;
            transform: translate(-15rem, 0px)">“</p>
    <p class="normalContent" style="">
        The investigation progress of this incident is largely driven by the public opinions on the
        Internet. It proved that Internet public opinion has a great amount of positive energy and has
        become <span class="normalContentHighlight">an indispensable part of the driving force for China’s governance progress</span>.

<!--        The progress (of this incident) is largely driven by <span class="normalContentHighlight">Internet public opinion</span>,-->
<!--        which has enormous positivity, and has become an indispensable part of the driving force for governance-->
<!--        progress.-->
    </p>

    <div style="float: right; display: flex;">
        <p class="normalContent" style="transform: translate(14rem, 1rem)"><span class="normalContentHighlight">@</span>
            Xijin Hu, former chief editor of <span style="font-style: italic;">Global Times</span></p>
        <img src="img/huxijin.png" style="width: 3rem; transform: translate(15rem, 0px)">
    </div>
</div>

<div id="quoteExit"></div>

<!--wind 链接卡片-->
<div id="windCard" class="windCard">
    <div style="margin-left: auto; margin-right: auto; width: 20rem; margin-bottom: 1.5rem">
        <svg id="windCardSvg" width="20rem"></svg>
        <!--        <img src="img/windglyph.png" style="width: 20rem;">-->
    </div>
    <div style="margin-left: auto; margin-right: auto; width: fit-content; ">
        <p id="windCardLine1" class="normalContentBigword" style="margin: 0rem; text-align: center">This is the result
            of visualizing public voices on Weibo</p>
        <p id="windCardLine2" class="normalContentBigword" style="margin: 0px; text-align: center">And we saw wisps of
            red, angry wind</p>
        <p class="normalContentHighlightLink" style="margin: 0px; margin-top: 1rem; text-align: center">See FULL
            visualization project</p>
    </div>
</div>


<div id="designWithDataCatalogEnter"></div>
<!--Design with data-->
<div style="margin-left: 20rem; margin-right: 20rem; margin-top: 10rem; margin-bottom: 15rem; ">
    <img src="img/Vr.png"
         style="position: absolute; width: 20rem; transform: translate(-20rem, 0px); margin-top: -5rem">
    <img src="img/mars.png" style="position: absolute; right: 0; width: 20rem;margin-top: -2rem">
    <p class="h2title" style="text-align: center; margin-bottom: 8rem"><span class="fontWhite">DESIGN WITH</span> <span
            class="fontGrad45">DATA</span></p>
    <p class="normalContent">When people are talking about the Metaverse, emigrating to Mars and other fancy things
        alike, it’s unbelievable that in some impoverished rural areas, even the most basic <span
                class="normalContentHighlight">human rights</span> are being violated. That’s why I started a design
        project focusing on this incident</p>
    <p class="normalContent" style="margin-top: 2rem">
<!--        Since most discussions of this incident happened online, where-->
<!--        public opinion can easily be measured by data, I wanted to finish my design utilizing <span-->
<!--                class="normalContentHighlight">data on social media</span>.-->
        Since most public discussions of this incident happened online, I decided
        to create my design with the <span class="normalContentHighlight">social media data</span>.

    </p>
    <p class="normalContentBigword" style="margin-top: 2rem">Through this work, I aimed to demonstrate the <span
            class="normalContentBigwordHighlight">incomparable strength of public opinion</span> visually, and call for
        more awareness and actions towards human trafficking and many other social issues alike.</p>
    <div id="designWithDataTitEx"></div>


</div>
<div id="designWithDataCatalogExit"></div>

<div id="designQuestionsCatalogEnter"></div>
<!--Design Questions-->
<div style="margin-left: 20rem; margin-right: 20rem; margin-top: 10rem; margin-bottom: 15rem">
    <p class="h2title" style="text-align: center; margin-bottom: 8rem"><span class="fontWhite">DESIGN </span> <span
            class="fontGrad45">QUESTIONS</span></p>
    <p class="normalContent" style="margin-bottom: 2rem">
        With the data, I focused on answering following questions:
    </p>

    <div style="display: flex; flex-direction: row; margin-bottom: 1rem; align-items: center;">
        <p class="h2title fontGrad45" style="margin: 0px; margin-right: 1rem; font-size: 2rem; height: fit-content">
            1</p>
        <p class="normalContentBigword" style="margin: 0px; height: fit-content">What <span
                class="normalContentBigwordHighlight">voices</span> were made in different stages of this saga?
            Who were <span class="normalContentBigwordHighlight">influencers</span> of this incident?</p>
    </div>

    <div style="display: flex; flex-direction: row; margin-bottom: 1rem; align-items: center;">
        <p class="h2title fontGrad45" style="margin: 0px; margin-right: 1rem; font-size: 2rem; height: fit-content">
            2</p>
        <p class="normalContentBigword" style="margin: 0px; height: fit-content">How to portrait the <span
                class="normalContentBigwordHighlight">overview</span> of public opinions?</p>
    </div>

    <div style="display: flex; flex-direction: row; margin-bottom: 1rem; align-items: center;">
        <p class="h2title fontGrad45" style="margin: 0px; margin-right: 1rem; font-size: 2rem; height: fit-content">
            3</p>
        <p class="normalContentBigword" style="margin: 0px; height: fit-content">Are there <span
                class="normalContentBigwordHighlight">similar cases</span> around the world? Where and how many?</p>
    </div>

    <div style="display: flex; flex-direction: row; margin-bottom: 1rem; align-items: center;">
        <p class="h2title fontGrad45" style="margin: 0px; margin-right: 1rem; font-size: 2rem; height: fit-content">
            4</p>
        <p class="normalContentBigword" style="margin: 0px; height: fit-content"> How to reflect <span
                class="normalContentBigwordHighlight">data humanism</span> in visual design?</p>
    </div>

</div>
<div id="designQuestionsCatalogExit"></div>

<div id="dataCollectionCatalogEnter"></div>
<!--Data Collection-->
<div style="margin-left: 20rem; margin-right: 20rem; margin-top: 10rem;">
    <p class="h2title" style="text-align: center; margin-bottom: 8rem"><span class="fontWhite">DATA</span> <span
            class="fontGrad45">COLLECTION</span></p>
    <p class="normalContent">I collected data from <a class="normalContentHighlight" style="text-decoration: underline"
                                                      href="https://weibo.com" target="_blank">weibo.com</a>, and human
        trafficking data from <a class="normalContentHighlight" href="https://www.ctdatacollaborative.org/"
                                 target="_blank">Counter Trafficking Data Collaborative (CTDC)</a>.</p>
</div>
<div id="trigger1"></div>

<!--Data Collection-->
<div class="row" style="margin-right: 5rem; margin-left: 5rem; ">
    <div class="col-lg" style="">
        <div style="padding: 5rem; ">
            <div style="margin-bottom: 16rem; margin-top: 8rem">
                <p class="normalContentBigword" style="margin-bottom: 0em">To answer the <span
                        class="normalContentBigwordHighlight">first design question</span>, </p>
                <p class="normalContent">data of <span class="bigNumbers fontGrad45">4,725</span> posts from <a
                        class="normalContentHighlight" style="text-decoration: underline" href="https://weibo.com"
                        target="_blank">weibo.com</a> were collected.</p>
                <div id="postTriggerExit"></div>
            </div>

            <div style="margin-bottom: 16rem">
                <div id="emotionTriggerEnter"></div>
                <p class="normalContent">I used API from Baidu AI open platform and processed the result to get the
                    sentiment score between 0 and 1.</p>
                <div id="emotionTriggerExit"></div>
            </div>

            <div style="margin-bottom: 16rem">
                <div id="hashtagTriggerEnter"></div>
                <p class="normalContentBigword" style="margin-bottom: 0rem">To answer the <span
                        class="normalContentBigwordHighlight">second design question</span>, </p>
                <p class="normalContent">data of <span class="bigNumbers fontGrad45">142</span> hashtags from <a
                        class="normalContentHighlight" style="text-decoration: underline" href="https://weibo.com"
                        target="_blank">weibo.com</a> were collected.</p>
                <div id="hashtagTriggerExit"></div>

            </div>

            <div style="margin-bottom: 16rem">
                <div id="hashtagGraphEnter"></div>
                <p class="normalContent" style="margin-bottom: 1rem">
                    However, many hashtags had similar content, so I categorized them.
                </p>
                <p class="normalContent" style="margin-bottom: 0rem">The distribution of hashtag numbers over time
                    indicates <span class="normalContentHighlight">a strong correlation between hashtags and official reports</span>.
                </p>
                <div id="hashtagGraphExit"></div>
            </div>

            <div style="margin-bottom: 16rem">
                <div id="postCatEnter"></div>
                <p class="normalContent" style="margin-bottom: 0rem">It inspired me to sort hashtags and posts into
                    following 8 groups.</p>
                <div id="postCatExit"></div>
            </div>

            <div style="margin-bottom: 16rem">
                <div id="victimEnter"></div>
                <p class="normalContent" style="margin-bottom: 0rem">To answer the <span class="normalContentHighlight">third design question</span>,
                </p>
                <p class="normalContent">data of <span class="bigNumbers fontGrad45">97, 750</span> victims of human
                    trafficking from <a class="normalContentHighlight" style="text-decoration: underline"
                                        href="https://www.ctdatacollaborative.org/" target="_blank">CTDC</a> were
                    collected.</p>
                <div id="victimExit"></div>
            </div>


        </div>


    </div>

    <div class="col-lg">
        <div id="divFixed" style="padding: 3rem; padding-right: 0px; padding-top: 0rem; ">
            <svg id="svg1">
            </svg>
        </div>
    </div>
</div>
<div id="dataCollectionCatalogExit"></div>


<div id="designProcessCatalogEnter"></div>
<!--Design Process-->
<div style="margin-left: 20rem; margin-right: 20rem; margin-top: -5rem; margin-bottom: 2rem">
    <p class="h2title" style="text-align: center; margin-bottom: 8rem"><span class="fontWhite">DESIGN </span> <span
            class="fontGrad45">PROCESS</span></p>
    <p class="h3title" style="text-align: center; margin-bottom: 0rem"><span class="fontWhite"
                                                                             style="text-decoration: underline">Ideation for </span><span
            class="fontHighlight" style="text-decoration: underline">Metaphors</span></p>
    <p class="h4title" style="text-align: center; margin-top: .5rem; margin-bottom: 2rem"><span class="fontWhite">Design question 4</span>
    </p>
    <p class="normalContent">
        I began by looking for appropriate visual metaphors for <span class="normalContentHighlight">posts</span> and <span class="normalContentHighlight">the power of public opinion</span>.
    </p>
</div>
<!--metaphor1-->
<div class="row" style="margin-right: 5rem; margin-left: 5rem; ">
    <div class="col-lg">
        <div style="padding: 5rem; padding-bottom: 2rem">
            <div style="margin-bottom: 8rem; margin-top: 8rem">
                <p class="h4title fontGrad45" style="margin-bottom: 1rem; text-decoration: underline">Samara seeds -
                    posts</p>
                <p class="normalContent">Like posts on social media, samara seeds represents freedom, are easy to spread and take root.</p>
            </div>
        </div>
    </div>

    <div class="col-lg">
        <div style="padding: 5rem; padding-top: 9rem">
            <img src="img/seed.png" style="width: 12rem">
        </div>
    </div>
</div>
<!--metaphor2-->
<div class="row" style="margin-right: 5rem; margin-left: 5rem; ">
    <div class="col-lg">

        <div style="padding: 3rem; padding-left: 5rem; padding-top: 0rem">
            <img src="img/wind.png" style="width: 20rem;">
        </div>

    </div>

    <div class="col-lg">
        <div style="padding: 5rem; ">
            <div style="margin-bottom: 8rem;">
                <p class="h4title fontGrad45" style="margin-bottom: 1rem; text-decoration: underline">Wind -
                    hashtags</p>
                <p class="normalContent">Like public opinions, wind is intangible yet powerful and influential.
                    This metaphor is <span class="normalContentHighlight">consistent</span>: wind carries
                    seeds just as hashtags contain posts, and it also provides an image of freedom.</p>
            </div>
        </div>
    </div>
</div>

<!--seed glyph-->
<div style="margin-left: 20rem; margin-right: 20rem; margin-bottom: 2rem">
    <p class="h3title" style="text-align: center; margin-bottom: 0rem"><span class="fontWhite"
                                                                             style="text-decoration: underline">Visualize the </span><span
            class="fontHighlight" style="text-decoration: underline">Voices</span></p>
    <p class="h4title" style="text-align: center; margin-top: .5rem; margin-bottom: 2rem"><span class="fontWhite">Design question 1</span>
    </p>
</div>

<!--<div class="row" style="position:fixed; top: 0px; left:0px; width: 100%; height: 100%; margin-left: 5rem; margin-right: 5rem">-->
<!--    <div class="col-lg"></div>-->
<!--    <div class="col-lg">123</div>-->
<!--</div>-->


<div class="row" style="margin-right: 5rem; margin-left: 5rem; ">
    <div class="col-lg">
        <div style="padding: 5rem; padding-top: 8rem; padding-bottom: 3rem">
            <div style="margin-bottom: 8rem;">
                <p class="h4title fontWhite" style="margin-bottom: 1rem;">Data</p>
                <p class="normalContent">This visualization part used the data from <span
                        class="normalContentHighlight">4,725 posts</span>.</p>
                <div id="seedGlyphDataExit"></div>
            </div>
        </div>

        <div style="padding: 5rem; ">
            <div id="encodePostEnter"></div>

            <div id="seedEncodeFixed" style="margin-bottom: 8rem;">
                <p class="h4title fontWhite" style="margin-bottom: 1rem;">Encode post data into seed glyph</p>
                <p class="normalContent"> I started by sorting out the post attributes by their information importance. </p>

            </div>
            <div id="encodePostExit"></div>

        </div>
        <div style="padding: 5rem; padding-top: 3rem; padding-bottom: 8rem">
            <div style="margin-bottom: 0rem;">
                <p class="normalContent" style="margin: 0rem">To begin with, I answered <span
                        class="normalContentHighlight">"who were influencers of this incident?"</span> by mapping
                    according attributes to the seed glyph and making influential posts more visually dominant.</p>
            </div>
        </div>

        <div style="padding: 5rem; padding-top: 8rem; padding-bottom: 8rem">
            <div style="margin-bottom: 0rem;">
                <div id="seedDataApplyEnter"></div>
                <p class="normalContent">Then I played with different parameters on real data utilizing d3.js. This is what I got:</p>
                <div id="seedDataApplyExit"></div>
            </div>
        </div>

        <div style="padding: 5rem; padding-top: 8rem; padding-bottom: 8rem">
            <div style="margin-bottom: 0rem;">
                <div id="seedQ2Enter"></div>
                <p class="normalContent">To answer <span class="normalContentHighlight">"what voices were made in different stages?"</span>,
                    I used the <span class="normalContentHighlight">post time</span>, <span class="normalContentHighlight">hashtag groups</span> and <span class="normalContentHighlight">sentiment</span> to map seeds layout. My sketch looks like:</p>
                <div id="seedQ2Exit"></div>

            </div>
        </div>

        <div style="padding: 5rem; padding-top: 8rem; padding-bottom: 8rem">
            <div style="margin-bottom: 0rem;">
                <div id="seedClusterEnter"></div>
                <p class="normalContent">
<!--                    After applying real data, I found giving every glyph an absolute coordinate-->
<!--                    according to its post time and sentiment could result in clustering.-->
                    After applying real data, I found that the glyphs from the same
                    hashtag groups were <span class="normalContentHighlight">overlapping</span> when posts had similar sentiment and were posted at the
                    similar time.
                </p>
                <div id="seedClusterExit"></div>
            </div>
        </div>

        <div style="padding: 5rem; padding-top: 8rem; padding-bottom: 8rem">
            <div style="margin-bottom: 0rem;">
                <div id="seedForceLayoutEnter"></div>
                <p class="normalContent">
                    Therefore I applied <span class="normalContentHighlight">a repulsive force</span> by d3.js to push the overlapping glyphs apart.
                </p>
                <div id="seedForceLayoutExit"></div>
            </div>
        </div>

    </div>

    <div class="col-lg">
        <div id="divFixed2" style="padding: 3rem; padding-right: 0px; padding-top: 0rem; ">
            <svg id="svg2">

            </svg>
        </div>
    </div>
</div>

<!--wind-->
<div style="margin-left: 20rem; margin-right: 20rem; margin-bottom: 2rem">
    <p class="h3title fontWhite" style="text-align: center; margin-bottom: 0rem; text-decoration: underline">
        Visualize<span class="fontHighlight" style="text-decoration: underline"> Overview </span>of Public Opinions</p>
    <p class="h4title" style="text-align: center; margin-top: .5rem; margin-bottom: 2rem"><span class="fontWhite">Design question 2</span>
    </p>
</div>
<div class="row" style="margin-right: 5rem; margin-left: 5rem; ">
    <div class="col-lg">
        <div style="padding: 5rem; padding-top: 8rem; padding-bottom: 3rem">
            <div style="margin-bottom: 8rem;">
                <div id="windDataEnter"></div>
                <p class="h4title fontWhite" style="margin-bottom: 1rem;">Data</p>
                <p class="normalContent">This visualization part used the data from <span
                        class="normalContentHighlight">142 hashtags</span>.</p>
            </div>
        </div>


        <div id="windDataFixed" style="padding: 5rem; padding-top: 3rem; padding-bottom: 8rem">
            <div style="margin-bottom: 0rem;">
                <p class="normalContent" style="margin: 0rem">Similarly, I began by grouping and sorting attributes.</p>
                <div id="windDataExit"></div>
            </div>
        </div>
        <div id="windDataExitExit"></div>


        <div style="padding: 5rem; padding-top: 8rem; padding-bottom: 8rem">
            <div style="margin-bottom: 0rem;">
                <div id="windMapEnter"></div>
                <p class="normalContent">Then I brainstormed the appearance of wind, and was inspired by <span
                        class="normalContentHighlight">this amazing work of wind visualization</span>. Therefore, I decided to
                    present wind glyph also with CURVES. </p>
                <div id="windMapExit"></div>

            </div>
        </div>

        <div style="padding: 5rem; padding-top: 8rem; padding-bottom: 8rem">
            <div style="margin-bottom: 0rem;">
                <div id="windSketchAttrsMapEnter"></div>
                <p class="normalContent">I also sketched possible visual channels and mapping rules of the wind.</p>
                <p class="normalContent"> Mapping <span
                        class="normalContentHighlight">create time & active time duration</span>, <span class="normalContentHighlight">hashtag group</span>,
                    and <span class="normalContentHighlight">average sentiment</span> were similar as seeds layout.
                </p>
                <div id="windSketchAttrsMapExit"></div>

            </div>
        </div>

        <div style="padding: 5rem; padding-top: 8rem; padding-bottom: 8rem">
            <div style="margin-bottom: 0rem;">
                <div id="windSketchMapEnter"></div>
                <p class="normalContent">
                    The huge challenge is to map <span class="normalContentHighlight">no. of views</span>, <span
                        class="normalContentHighlight">originals</span>, and <span class="normalContentHighlight">discussions</span>; it’s difficult to encode
                    these attributes into a simple wind curve that contains three visual channels.

                </p>
                <p class="normalContent"> This is one solution I tried:</p>
                <div id="windSketchMapExit"></div>

            </div>
        </div>

        <div style="padding: 5rem; padding-top: 8rem; padding-bottom: 8rem">
            <div style="margin-bottom: 0rem;">
                <div id="demenRedEnter"></div>
                <p class="normalContent">
<!--                    After applying real data, however, I found these three dimensions can <span-->
<!--                        class="fontHighlight">be reduced to one with a conclusive representation of "public influence"</span>,-->
<!--                    which can therefore be encoded into one visual channel.-->

<!--                    After applying the real data, I found that there were actually only three different-->
<!--                    wind glyphs to represent “public influence”. -->

                    After applying real data, I found these three attributes <span class="normalContentHighlight">can be reduced to one with a
                    conclusive representation of "public influence"</span>. Then I encoded it into one visual channel: curve shape.
                </p>
                <div id="demenRedExit"></div>

            </div>
        </div>

        <div id="dimensionRedDiv" class="row"
             style="opacity: 0; position: fixed; top: 0rem; left: 0rem; margin: 5rem; z-index: -1">
            <div class="col-lg"></div>
            <div class="col-lg">
                <div class="row" style="padding-left: 2rem; padding-top: 2rem">
                    <div class="col-lg">
                        <div style="display: flex; flex-direction: column">
                            <img src="img/view.svg" style="width: 2rem; flex-basis: 4rem">
                            <img src="img/comments.svg" style="width: 2rem; flex-basis: 4rem">
                            <img src="img/original.svg" style="width: 2rem; flex-basis: 4rem">
                            <div class="handContent" style="flex-basis: 4rem; display: flex;  align-items: center">
                                <p style="margin: 0rem; font-size: .8rem">Influence</p>
                            </div>

                            <div class="handContent" style="flex-basis: 4rem; display: flex;  align-items: center">
                                <p style="margin: 0rem; font-size: .8rem">Included hashtags</p>
                            </div>

                            <div class="handContent" style="flex-basis: 4rem; display: flex;  align-items: center">
                                <p style="margin: 0rem; font-size: .8rem">Shape</p>
                            </div>

                        </div>
                    </div>

                    <div class="col-lg">
                        <div style="display: flex; flex-direction: column">
                            <div class="handContent" style="flex-basis: 4rem; display: flex;  align-items: center">
                                <p style="margin: 0rem;font-size: .6rem; opacity: .6; color: #FFFFFF"><500M</p>
                            </div>

                            <div class="handContent" style="flex-basis: 4rem; display: flex;  align-items: center">
                                <p style="margin: 0rem;font-size: .6rem; opacity: .6; color: #FFFFFF"><200K</p>
                            </div>

                            <div class="handContent" style="flex-basis: 4rem; display: flex;  align-items: center">
                                <p style="margin: 0rem;font-size: .6rem; opacity: .6; color: #FFFFFF"><5K</p>
                            </div>
                            <div class="handContent" style="flex-basis: 4rem; display: flex;  align-items: center">
                                <p style="margin: 0rem;font-size: .7rem; opacity: .6; color: #FFFFFF">+</p>
                            </div>
                            <div class="handContent" style="flex-basis: 4rem; display: flex;  align-items: center">
                                <p style="margin: 0rem;font-size: .7rem; opacity: .6; color: #FFFFFF">report 2,
                                    reflection, other</p>
                            </div>

                            <div class="handContent" style="flex-basis: 4rem; display: flex;  align-items: center">
                                <img src="img/wind1.png" style="width: 4rem;"/>
                            </div>
                        </div>

                    </div>

                    <div class="col-lg">

                        <div style="display: flex; flex-direction: column">
                            <div class="handContent" style="flex-basis: 4rem; display: flex;  align-items: center">
                                <p style="margin: 0rem;font-size: .6rem; opacity: .6; color: #FFFFFF">500M - 4B</p>
                            </div>

                            <div class="handContent" style="flex-basis: 4rem; display: flex;  align-items: center">
                                <p style="margin: 0rem;font-size: .6rem; opacity: .6; color: #FFFFFF">200K - 2M</p>
                            </div>

                            <div class="handContent" style="flex-basis: 4rem; display: flex;  align-items: center">
                                <p style="margin: 0rem;font-size: .6rem; opacity: .6; color: #FFFFFF">5K - 50K</p>
                            </div>
                            <div class="handContent" style="flex-basis: 4rem; display: flex;  align-items: center">
                                <p style="margin: 0rem;font-size: .7rem; opacity: .6; color: #FFFFFF">+ +</p>
                            </div>
                            <div class="handContent" style="flex-basis: 4rem; display: flex;  align-items: center">
                                <p style="margin: 0rem;font-size: .7rem; opacity: .6; color: #FFFFFF">report 3, 4, 6</p>
                            </div>

                            <div class="handContent" style="flex-basis: 4rem; display: flex;  align-items: center">
                                <img src="img/wind2.png" style="width: 4rem;"/>
                            </div>
                        </div>

                    </div>

                    <div class="col-lg">
                        <div style="display: flex; flex-direction: column">
                            <div class="handContent" style="flex-basis: 4rem; display: flex;  align-items: center">
                                <p style="margin: 0rem;font-size: .6rem; opacity: .6; color: #FFFFFF">>4B</p>
                            </div>

                            <div class="handContent" style="flex-basis: 4rem; display: flex;  align-items: center">
                                <p style="margin: 0rem;font-size: .6rem; opacity: .6; color: #FFFFFF">>2M</p>
                            </div>

                            <div class="handContent" style="flex-basis: 4rem; display: flex;  align-items: center">
                                <p style="margin: 0rem;font-size: .6rem; opacity: .6; color: #FFFFFF">>50K</p>
                            </div>
                            <div class="handContent" style="flex-basis: 4rem; display: flex;  align-items: center">
                                <p style="margin: 0rem;font-size: .7rem; opacity: .6; color: #FFFFFF">+ + + </p>
                            </div>
                            <div class="handContent" style="flex-basis: 4rem; display: flex;  align-items: center">
                                <p style="margin: 0rem;font-size: .7rem; opacity: .6; color: #FFFFFF">report 1, 5</p>
                            </div>

                            <div class="handContent" style="flex-basis: 4rem; display: flex;  align-items: center">
                                <img src="img/wind3.png" style="width: 4rem;"/>
                            </div>
                        </div>
                    </div>

                </div>

            </div>
        </div>
        <div id="Attr3MapDiv" class="row"
             style="opacity: 0; position: fixed; top: 0rem; left: 0rem; margin: 5rem; z-index: -1">
            <div class="col-lg"></div>
            <div class="col-lg">
                <div class="row" style="margin-top: 8rem">
                    <div class="col-lg">
                        <div style="display: flex; flex-direction: column; align-items: center;">
                            <div style="flex-basis: 8rem">
                                <img src="img/windSketch1.png" style="width: 8rem; margin-top: .4rem">
                            </div>
                            <p class="handContent" style="font-size: .7rem; color: rgba(255,255,255,0.8)">end
                                curvedness: no. of views</p>
                        </div>
                    </div>

                    <div class="col-lg">
                        <div style="display: flex; flex-direction: column; align-items: center;">
                            <div style="flex-basis: 8rem">
                                <img src="img/windSketch2.png" style="width: 8rem; margin-top: 1rem">
                            </div>
                            <p class="handContent" style="font-size: .7rem; color: rgba(255,255,255,0.8)">stroke width:
                                no. of discussions</p>
                        </div>
                    </div>

                    <div class="col-lg">
                        <div style="display: flex; flex-direction: column; align-items: center;">
                            <div style="flex-basis: 8rem">
                                <img src="img/windSketch3.png" style="width: 8rem;">
                            </div>
                            <p class="handContent" style="font-size: .7rem; color: rgba(255,255,255,0.8)">gradient
                                proportion: no. of originals</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div style="padding: 5rem; padding-top: 8rem; padding-bottom: 8rem">
            <div style="margin-bottom: 0rem;">
                <p class="normalContent">And there it goes! This is my result of visualizing the overview of public
                    opinions: <span class="normalContentHighlight">an angry wind</span>.</p>
                <div id="windDesignResExit"></div>
            </div>
        </div>


    </div>

    <div class="col-lg">
        <div id="divFixed6" style="padding: 3rem; padding-top: 0rem; padding-left: 1rem; padding-right: 0px; ">
            <svg id="svg6">

            </svg>
        </div>
    </div>
</div>


<!--similar cases worldwide-->
<div style="margin-left: 20rem; margin-right: 20rem; margin-bottom: 2rem">
    <p class="h3title fontWhite" style="text-align: center; margin-bottom: 0rem; text-decoration: underline">
        Visualize<span class="fontHighlight" style="text-decoration: underline"> Similar Cases </span>Worldwide</p>
    <p class="h4title" style="text-align: center; margin-top: .5rem; margin-bottom: 2rem"><span class="fontWhite">Design question 3</span>
    </p>
</div>
<div class="row" style="margin-right: 5rem; margin-left: 5rem; ">
    <div class="col-lg">
        <div style="padding: 5rem; padding-top: 3rem; padding-bottom: 3rem">
            <div style="margin-bottom: 8rem;">
                <p class="h4title fontWhite" style="margin-bottom: 1rem;">Data</p>
                <p class="normalContent">This visualization part used the data from <a class="normalContentHighlight" href="https://www.ctdatacollaborative.org/"
                                                                                       target="_blank">97,750 victims of human trafficking</a> (from CTDC).</p>
            </div>
        </div>

        <div style="padding: 5rem; ">
            <div style="margin-bottom: 8rem;">
                <div id="mapSketchEnter"></div>
                <p class="h4title fontWhite" style="margin-bottom: 1rem;">Sketch</p>
                <p class="normalContent">In order to tell a <span class="normalContentHighlight">consistent</span>
                    visual story, I still used the glyph of wind, which is the metaphor of <span
                            class="normalContentHighlight">public voices</span>.</p>
                <p class="normalContent"> Larger wind glyph indicates more human trafficking cases, which implies
                    more awareness, public voice and action are needed.</p>
                <div id="mapSketchExit"></div>
            </div>
        </div>

        <div style="padding: 5rem; ">
            <div style="margin-bottom: 8rem;">
                <div id="oneGlyphEnter"></div>
                <p class="h4title fontWhite" style="margin-bottom: 1rem;">Result</p>
                <p class="normalContent">One wind glyph represents one country with human trafficking case(s). Then I realized that I can group the cases by <span class="normalContentHighlight">the geographies of the
                    countries</span>.</p>
                <div id="oneGlyphExit"></div>
            </div>
        </div>

        <div style="padding: 5rem; ">
            <div style="margin-bottom: 8rem;">
                <div id="kMeansEnter"></div>
                <p class="normalContent">
                    So I tried <span class="normalContentHighlight">KMeans clustering algorithm</span> and different calculation methods for
                    clustered centroid.
<!--                    Then I tested <span class="normalContentHighlight">KMeans</span>, an algorithm-->
<!--                    for clustering, and different calculation method for clustered centroid.</p>-->
                <p class="normalContent">clustered centroid equals:</p>
                <div style="display: flex; flex-direction: row">
                    <div style="display: flex; flex-direction: column; margin-right: 2rem">
                        <button id="switchMapBtn0" type="button" class="buttonSelected normalContent"
                                style="margin-bottom: .5rem" onclick="switchMapTo(1)">mean coordinates of countries
                        </button>
                        <button id="switchMapBtn1" type="button" class="buttonUnSelected normalContent" style=""
                                onclick="switchMapTo(0)">weighed coordinates of countries
                        </button>
                    </div>

                    <div style="display: flex; flex-direction: column">
                        <button id="switchMapQ0" type="button" class="questionUnSelected normalContent"
                                style="margin-bottom: .5rem" onmouseover="questionMap(0, 1)"
                                onmouseleave="questionMap(0, 0)">?
                        </button>
                        <button id="switchMapQ1" type="button" class="questionUnSelected normalContent"
                                style="opacity: 0" onmouseover="questionMap(1)">?
                        </button>
                    </div>

                </div>
                <div id="kMeansExit"></div>


            </div>

        </div>

        <div style="padding: 5rem; ">
            <div style="margin-bottom: 8rem;">
                <div id="mapProbEnter"></div>
                <p class="normalContent">However, this algorithm sometimes might produce unreasonable results.</p>
                <div id="mapProbExit"></div>

            </div>
        </div>

        <div style="padding: 5rem; ">
            <div style="margin-bottom: 8rem;">
                <div id="mapContinentEnter"></div>
                <p class="normalContent">Eventually, I decided to group the cases by continents.</p>
                <div id="mapContinentExit"></div>

            </div>
        </div>


    </div>

    <div class="col-lg">
        <div id="divFixed5" style="padding: 3rem; padding-left: 1rem; padding-right: 0px; padding-top: 10rem; ">
            <svg id="svg5">

            </svg>
        </div>
    </div>
</div>
<div id="designProcessCatalogExit"></div>

<div id="otherChallengesCatalogEnter"></div>
<!--Other Challenges1-->
<div style="margin-left: 20rem; margin-right: 20rem; margin-top: 0rem; margin-bottom: 0rem; ">

    <p class="h2title fontWhite" style="text-align: center; margin-bottom: 8rem">OTHER <span class="fontGrad45">CHALLENGES</span>
    </p>
    <p class="h3title fontWhite" style="margin-bottom: 2rem; text-align: center; text-decoration: underline">Demonstrate
        <span class="fontHighlight" style="text-decoration: underline">Micro & Macro Features</span> Simultaneously</p>

</div>
<!--Other Challenges1-->
<div class="row" style="margin-right: 5rem; margin-left: 5rem; ">
    <div class="col-lg">
        <div style="padding: 5rem; padding-top: 14rem; padding-bottom: 3rem">
            <div style="margin-bottom: 8rem;">
                <div id="otherChallenge1Enter"></div>
                <p class="normalContent">In the design process, I found that it was difficult to observe micro and
                    macro features of seed glyph at the same time. </p>
                <p class="normalContent">
                    When <span class="normalContentHighlight">zoomed in</span> to the details, the user
                    would lose the big picture of the visualization; when <span class="normalContentHighlight">zoomed out</span>, the user could not clearly
                    perceive the details and interact with each glyph.

<!--                    When <span class="normalContentHighlight">zoom in</span> for detail, the layout-->
<!--                    is too big to view in its entirety. When <span class="normalContentHighlight">zoom out</span> to see-->
<!--                    the overall structure, small details are lost, and interaction with glyph (e.g. to show tooltip) is-->
<!--                    rather difficult.-->
                </p>
                <div id="otherChallenge1Exit"></div>

            </div>
        </div>

        <div style="padding: 5rem; ">

            <div style="margin-bottom: 8rem;">
                <div id="fisheyeSketchEnter"></div>
                <p class="h4title fontWhite" style="margin-bottom: 1rem;">Solution</p>
                <p class="normalContent">I wanted to use <span class="normalContentHighlight">Focus + Context</span>
                    technique, which allows interactive exploration of an area of interest (the focus) in greater
                    detail, while preserving the surrounding environment (the context).</p>
                <div id="fisheyeSketchExit"></div>

            </div>
        </div>
        <div style="padding: 5rem; padding-top: 3rem; padding-bottom: 0rem">
            <div style="margin-bottom: 0rem;">
                <div id="fisheyeSketch2Enter"></div>
                <p class="normalContent">Eventually, I decided to use a <span class="normalContentHighlight">fisheye distortion technique</span> to the layout, which magnifies the local region around the mouse, while leaving the larger graph
                    unaffected for context.</p>
                <div id="fisheyeSketch2Exit"></div>

            </div>
        </div>

    </div>
    <div class="col-lg">
        <div id="divFixed3" style="padding-bottom: 0rem; padding-left: 1rem; padding-right: 0px; padding-top: 0rem; ">
            <svg id="svg3">

            </svg>
        </div>
    </div>
</div>

<!--Other Challenges2-->
<div style="margin-left: 20rem; margin-right: 20rem; margin-top: 0rem; margin-bottom: 6rem; ">
    <p class="h3title fontWhite"
       style="margin-bottom: 2rem; text-align: center; margin-top: 0rem; text-decoration: underline">How to Make
        Contextual <span class="fontHighlight" style="text-decoration: underline">Mapping Rules</span> More
        Understandable</p>
</div>
<!--Other Challenges2-->
<div class="row" style="margin-right: 5rem; margin-left: 5rem; ">
    <div class="col-lg">
        <div style="padding: 5rem; padding-top: 8rem; padding-bottom: 3rem">
            <div style="margin-bottom: 8rem;">
                <div id="otherChallenge2Enter"></div>
                <p class="normalContent">In seed glyph layout and wind glyph design, Y-axis and X-axis of the web page
                    were used to represent timeline respectively, which might confuse readers.</p>
                <div id="otherChallenge2Exit"></div>

            </div>
        </div>

        <div id="optionA" style="padding: 5rem; padding-bottom: 3rem">
            <div style="margin-bottom: 8rem;">
                <div id="optionAEnter"></div>
                <p class="h4title fontWhite" style="margin-bottom: 1rem;">Option A</p>
                <p class="normalContent">Map <span class="normalContentHighlight">Y-axis</span> of wind glyph into
                    timeline.</p>
                <p class="normalContent" style="margin-top: 6rem">Hmm... wind blowing downwards... A bit
                    counterintuitive</p>
                <div id="optionAExit"></div>
            </div>
        </div>
        <div style="padding: 5rem; padding-bottom: 3rem">
            <div style="margin-bottom: 8rem;">
                <div id="optionBEnter"></div>
                <p class="h4title fontWhite" style="margin-bottom: 1rem;">Option B</p>
                <p class="normalContent">Map <span class="normalContentHighlight">X-axis</span> of seed layout into
                    timeline.</p>
                <p class="normalContent" style="margin-top: 6rem">when there's a burst of posts at the same time, seeds
                    tend to fall into the scope of other hashtag groups</p>

                <div id="optionBExit"></div>
            </div>
        </div>

        <div id="optionCFixed" style="padding: 5rem; padding-bottom: 3rem">
            <div style="margin-bottom: 8rem;">
                <div id="optionCEnter"></div>
                <p class="h4title fontWhite" style="margin-bottom: 1rem;">Option C - <span class="fontHighlight">My Final Solution</span>
                </p>
                <p class="normalContent">Eventually, I used animation to convey the transition in mapping from X-axis to
                    Y-axis. This is also like the wind is blowing.
                </p>
                <div id="optionCExit"></div>
            </div>
        </div>
        <!--        <div style="padding: 5rem; padding-top: 3rem; padding-bottom: 3rem">-->
        <!--            <div style="margin-bottom: 0rem;">-->
        <!--                <p class="normalContent">To begin with, I answered <span class="normalContentHighlight">"who were influencers of this incident?"</span> by mapping according attributes to the seed glyph. Besides, I wanted to make influential posts stand out by making it more visually dominant.</p>-->
        <!--            </div>-->
        <!--        </div>-->

    </div>
    <div class="col-lg">
        <div id="divFixed4" style="padding-bottom: 0rem; padding-left: 1rem; padding-right: 0px; padding-top: 0rem; ">
            <svg id="svg4">

            </svg>
            <video id="windAnimVideo" src="video/windAnim.mp4" width="80%"
                   style="position: absolute;top: 6rem; left: 2rem; opacity: 0; "></video>
            <div id="windAnimXaxis" style="opacity: 0; position:absolute; top: 4rem; left: 4rem">
                <p class="handContent" style="margin-bottom: 0px; margin-left: 4rem">X-axis: timeline</p>
                <img src="img/arr3.png" width="500rem">
            </div>

            <div id="windAnimYaxis"
                 style="opacity: 0; position:absolute; top: 16rem; left: 16rem; transform: rotate(-90deg)">
                <img src="img/arr3.png" width="500rem" style="transform: scale(-1)">
                <p class="handContent" style="margin-bottom: 0px; margin-left: 4rem">Y-axis: timeline</p>
            </div>

        </div>
    </div>
</div>
<div id="otherChallengesCatalogExit"></div>

<div id="reflectionCatalogEnter"></div>
<!--Reflection-->
<div style="margin-left: 20rem; margin-right: 20rem; margin-top: 4rem; margin-bottom: 15rem; ">
    <div style="position:absolute; top: 0px; left: 0px">
        123
    </div>
    <img src="img/wenge.png"
         style="position: absolute; width: 20rem; transform: translate(-20rem, 8rem); margin-top: -5rem">
    <img src="img/arr1.png"
         style="position: absolute; width: 20rem; transform: translate(-14rem, 11rem)scale(0.15)rotate(45deg); margin-top: -5rem; opacity: .6">
    <p class="captionContent"
       style="position: absolute; width: 12rem;transform: translate(-16rem, 22rem); margin-top: -5rem">The Great
        Proletarian Cultural Revolution, the darkest age of Modern China, when millions of people suffered from
        political persecution</p>

    <div style="position:absolute; top: 0px; left: 0px">

        <img src="img/postTruth.png"
             style="position: absolute; right: 0; width: 15rem;margin-top: -2rem; transform: translate(-2rem, 25rem);opacity: .7">
        <img src="img/arr2.png"
             style="position: absolute; width: 20rem; transform: translate(25rem, 10rem)scale(0.1); margin-top: -5rem; opacity: .6">
        <p class="captionContent"
           style="position: absolute; width: 12rem;transform: translate(37rem, 42rem); margin-top: -5rem">Post-truth is a
            time when "objective facts are less influential in shaping public opinion than appeals to emotion and personal
            belief"</p>

    </div>


    <p class="h2title" style="text-align: center; margin-bottom: 8rem"><span class="fontGrad45">REFLECTION</span></p>

    <p class="h3title fontWhite_light" style="margin-bottom: 2rem; text-align: center; text-decoration: underline">
        Public Opinion and State Governance Complement Each Other</p>
    <p class="normalContent"><span class="normalContentHighlight">"We don't have enough to eat".</span> My grandfather
        spent 10 years in jail simply because he spoke out true condition of their lives.</p>
    <p class="normalContent">Today no wonder we live in a society that allows more freedom of speech. Yet we still see
        authorities censor politically sensitive topics heavily by deleting posts and accounts, banning articles,
        controlling trendings, etc. </p>
    <p class="normalContent">Instead of being afraid of or turning a deaf ear to public voices, the government should
        embrace them, and make positive changes. Public voice CAN make a difference, <span
                class="normalContentHighlight">it's not just about saving victims of human trafficking, it's about eliminating social injustice and prejudice.</span>
    </p>

    <p class="h3title fontWhite_light"
       style="margin-bottom: 2rem; text-align: center; margin-top: 4rem; text-decoration: underline">Think Twice of What
        You Say</p>
    <p class="normalContent">Powerful as public voice is, we should remind ourselves not to fall into the trap of <span
            class="normalContentHighlight">post-truth</span>.
        And let our <span class="normalContentHighlight">rationality</span> and <span class="normalContentHighlight">conscience</span> guide us, rather than irrational emotion and bias.</p>

    <p class="h3title fontWhite_light"
       style="margin-bottom: 2rem; text-align: center; margin-top: 4rem; text-decoration: underline">What Role Does Data
        Visualization Plays? </p>
    <p class="normalContent">I think data visualization is not only about telling the story of data, but about what is
        behind these data: <span class="normalContentHighlight">people</span>. It's about telling stories of our life,
        society, and this world; exposing injustices; provoking empathy, reflection and action, and providing valuable
        insights and solutions.</p>

</div>

<script>
    function geneSeed_Tp(tooltipSvg, tooltipDef, index, cx, cy, followercat, emo_neg_prob, commentCat, isVlevelOn, vlevel, gScale, like, comment, retweet,) {
        var scaleLengthId;
        var scaleWidthId;

        //like的映射计算; like的max值为2457804; 计算scaleWidthId
        let likeScale = d3.scaleLinear()
            .domain([0, 2.7])
            .range([1, 3]); //映射到的scaleWid范围
        if (like <= 5000) {
            scaleWidthId = 1;
        } else {
            scaleWidthId = likeScale(Math.log(like / 5000) / Math.log(10)) //取以10为底的对数
        }

        //retweet的映射计算；retweet的max值为418438；计算scaleLengthId
        let retweetScale = d3.scaleLinear()
            .domain([0, 3])
            .range([1, 3]); //映射到的scaleLen范围
        if (retweet <= 500) {
            scaleLengthId = 1;
        } else {
            scaleLengthId = retweetScale(Math.log(retweet / 500) / Math.log(10)) //取以10为底的对数
        }


        var group1 = tooltipSvg
            .append("g")
            .attr("id", `Tp_seed${index}`)
            .attr("transform", `translate(${cx}, ${cy}), rotate(-30) ,scale(${gScale})`) //rotate(-20,300,400)
        //.attr("transform","rotate(30,600,400)");

        //叶子宽度参数调整
        group1.append("path")
            .attr("d", `M ${185.11 * scaleLengthId} 23 ` +
                `C ${192.21 * scaleLengthId} 34.23 ${156.54 * 1.2 * scaleLengthId} ${57.89 * scaleWidthId} ${132.11 * scaleLengthId} ${57.89 * scaleWidthId} ` +
                `C ${100.6 * scaleLengthId} ${57.89 * scaleWidthId} ${75.04 * 0.8 * scaleLengthId} 30.79 38.58 30.79 ` +
                "C 50.93 16.55 69 8.67 69 8.67 " +
                `S ${162.94 * scaleLengthId} -12.13 ${185.11 * scaleLengthId} 23 ` +
                "Z")
            .style("fill", "#FFCA36")
            .style("opacity", "0.2")
            .style("stroke", "none");

        //评论数量调整纹理
        if (commentCat == 1) {

            group1.append("path")
                .attr("d", `M ${92.56 * (1.2 - 0.2 * scaleLengthId) * scaleLengthId} ${4.3} C ${109.32 * (1.2 - 0.2 * scaleLengthId) * scaleLengthId} ${4.3} ${119.8 * (1.2 - 0.2 * scaleLengthId) * scaleLengthId} ${18.52 * scaleWidthId} ${121.61 * (1.2 - 0.2 * scaleLengthId) * scaleLengthId} ${32.74 * scaleWidthId}`)
                .style("stroke-linecap", "round")
                .attr("stroke-width", "2")
                .attr("opacity", "0.2")
                .attr("fill", "none")
                .attr("class", `Tp_seedleaf${index}`)
                .style("stroke", "#FFCA36");

            group1.append("path")
                .attr("d", `M${125.75 * scaleLengthId},2.55 C ${142.51 * scaleLengthId},2.55,${153 * scaleLengthId},${16.77 * scaleWidthId},${154.8 * scaleLengthId},${31 * scaleWidthId}`)
                // .attr("stroke", "#FFCA36")
                .style("stroke-linecap", "round")
                .attr("stroke-width", "2")
                .attr("opacity", "0.2")
                .attr("fill", "none")
                .attr("class", `Tp_seedleaf${index}`)
                .style("stroke", "#FFCA36");

        } else if (commentCat == 2) {

            group1.append("path")
                .attr("d", `M ${83.27 * (1.2 - 0.2 * scaleLengthId) * scaleLengthId} ${5.93 - Math.min(2, 2 * (scaleLengthId - 1))} C ${100.04 * (1.2 - 0.2 * scaleLengthId) * scaleLengthId} ${5.93 - Math.min(2, 2 * (scaleLengthId - 1))} ${110.52 * (1.2 - 0.2 * scaleLengthId) * scaleLengthId} ${20.15 * 0.8 * scaleWidthId} ${112.33 * (1.2 - 0.2 * scaleLengthId) * scaleLengthId} ${34.37 * 0.8 * scaleWidthId}`)
                .style("stroke-linecap", "round")
                .attr("stroke-width", "2")
                .attr("opacity", "0.2")
                .attr("fill", "none")
                .attr("class", `Tp_seedleaf${index}`)
                .style("stroke", "#FFCA36");

            group1.append("path")
                .attr("d", `M ${107.93 * (1.1 - 0.1 * scaleLengthId) * scaleLengthId} 2.55 C ${124.7 * (1.1 - 0.1 * scaleLengthId) * scaleLengthId} 2.55 ${138.45 * (1.1 - 0.1 * scaleLengthId) * scaleLengthId} ${16.77 * scaleWidthId} ${140.99 * (1.1 - 0.1 * scaleLengthId) * scaleLengthId} ${39.41 * scaleWidthId}`)
                .style("stroke-linecap", "round")
                .attr("stroke-width", "2")
                .attr("opacity", "0.2")
                .attr("fill", "none")
                .attr("class", `Tp_seedleaf${index}`)
                .style("stroke", "#FFCA36");

            group1.append("path")
                .attr("d", `M ${134 * scaleLengthId} 2.55 C ${150.76 * scaleLengthId} 2.55 ${159.2 * scaleLengthId} ${16.77 * scaleWidthId} ${161 * scaleLengthId} ${30.99 * scaleWidthId}`)
                .style("stroke-linecap", "round")
                .attr("stroke-width", "2")
                .attr("opacity", "0.2")
                .attr("fill", "none")
                .attr("class", `Tp_seedleaf${index}`)
                .style("stroke", "#FFCA36");


        } else {

            group1.append("path")
                .attr("d", `M ${71.86 * scaleLengthId} ${7.82 - Math.min(4, 4 * (scaleLengthId - 1))} C ${88.62 * scaleLengthId} 7.82 ${97.72 * scaleLengthId} ${24 * scaleWidthId} ${99.53 * scaleLengthId} ${38.19 * scaleWidthId}`)
                .style("stroke-linecap", "round")
                .attr("stroke-width", "2")
                .attr("opacity", "0.2")
                .attr("fill", "none")
                .attr("class", `Tp_seedleaf${index}`)
                .style("stroke", "#FFCA36");

            group1.append("path")
                .attr("d", `M ${97.8 * scaleLengthId} ${4.3 - Math.min(1.2, 1.2 * (scaleLengthId - 1))} C ${114.57 * scaleLengthId} 4.3 ${122.31 * scaleLengthId} ${29.05 * scaleWidthId} ${124.12 * scaleLengthId} ${43.3 * scaleWidthId}`)
                .style("stroke-linecap", "round")
                .attr("stroke-width", "2")
                .attr("opacity", "0.2")
                .attr("fill", "none")
                .attr("class", `Tp_seedleaf${index}`)
                .style("stroke", "#FFCA36");

            group1.append("path")
                .attr("d", `M ${119.78 * scaleLengthId} 2.55 C ${136.55 * scaleLengthId} 2.55 ${144.29 * scaleLengthId} ${27.3 * scaleWidthId} ${146.09 * scaleLengthId} ${41.55 * scaleWidthId}`)
                .style("stroke-linecap", "round")
                .attr("stroke-width", "2")
                .attr("opacity", "0.2")
                .attr("fill", "none")
                .attr("class", `Tp_seedleaf${index}`)
                .style("stroke", "#FFCA36");

            group1.append("path")
                .attr("d", `M ${140.49 * scaleLengthId} ${2.55 + Math.min(2.5, 2.5 * (scaleLengthId - 1))} C ${157.26 * scaleLengthId} 2.55 ${163.49 * scaleLengthId} ${22.83 * scaleWidthId} ${164.84 * scaleLengthId} ${33.67 * scaleWidthId}`)
                .style("stroke-linecap", "round")
                .attr("stroke-width", "2")
                .attr("opacity", "0.2")
                .attr("fill", "none")
                .attr("class", `Tp_seedleaf${index}`)
                .style("stroke", "#FFCA36");
        }

        //悬停交互
        var mouseover = function (d) {
            console.log(d3.select(this)
                .attr("id")
                .split("Tp_tooltipCircle")[1]
            )

            d3.select(`#Tp_emo_grad_end${d3.select(this)
                .attr("id")
                .split("Tp_tooltipCircle")[1]}`)
                .transition()
                .duration(500)
                .attr("offset", "1")
                .style("stop-opacity", "100%")

            d3.select(`#Tp_emo_grad_start${d3.select(this)
                .attr("id")
                .split("Tp_tooltipCircle")[1]}`)
                .transition()
                .duration(500)
                // .attr("offset", "1")
                .style("stop-color", "#ffca36");

            d3.selectAll(`.Tp_seedleaf${d3.select(this)
                .attr("id")
                .split("Tp_tooltipCircle")[1]}`)
                .transition()
                .duration(500)
                // .attr("offset", "1")
                .attr("opacity", "100%");

        }
        var mousemove = function (d) {

        }
        var mouseleave = function (d) {

            d3.select(`#Tp_emo_grad_end${d3.select(this)
                .attr("id")
                .split("Tp_tooltipCircle")[1]}`)
                .transition()
                .duration(500)
                .attr("offset", "0.1")
                .style("stop-opacity", "0")

            d3.select(`#Tp_emo_grad_start${d3.select(this)
                .attr("id")
                .split("Tp_tooltipCircle")[1]}`)
                .transition()
                .duration(500)
                // .attr("offset", "1")
                .style("stop-color", d3.select(
                    `#Tp_emo_grad_end${d3.select(this)
                        .attr("id")
                        .split("Tp_tooltipCircle")[1]}`)
                    .style("stop-color"));

            d3.selectAll(`.Tp_seedleaf${d3.select(this)
                .attr("id")
                .split("Tp_tooltipCircle")[1]}`)
                .transition()
                .duration(500)
                // .attr("offset", "1")
                .attr("opacity", "0.2");
        }


        //叶子长度参数调整; 粉丝数影响头部大小
        if (followercat == 1) {
            group1.append("path")
                .attr("d", "M 57.6 6.89 " +
                    "C 46 7.89 29.85 6.42 20.6 6.77 " +
                    `C 9.22 7.2 ${-1.68} 9.24 ${0.22} 18.61` +
                    `C 2.28 28.77 8.25 ${37} 21.44 ${37} ` +
                    "C 44 37 57.07 12.5 75 8.92 " +
                    `S ${162.06 * scaleLengthId} -6 ${185.11 * scaleLengthId} 23 ` +
                    `C ${181.44 * scaleLengthId} ${11.63 + 1 * scaleLengthId} ${157.88 * scaleLengthId} 0 ${126.41 * (1.2 - 0.2 * scaleLengthId) * (scaleLengthId)} 0 ` +
                    "S 81.12 4.86 57.6 6.89 " +
                    "Z")
                .attr("id", `Tp_seedStem${index}`)
                .style("fill", "#FFCA36")
                .style("stroke", "none");

            group1.append("circle")
                .attr("cx", 24)
                .attr("cy", 26)
                .attr("r", 18)
                .attr("id", `Tp_tooltipCircle${index}`)
                .attr("fill", "#000")
                .attr("opacity", "0")
                .on("mouseover", mouseover)
                .on("mousemove", mousemove)
                .on("mouseleave", mouseleave);

        } else if (followercat == 2) {

            group1.append("path")
                .attr("d", "M 57.6 6.89 " +
                    "C 46 7.89 29.85 6.42 20.6 6.77 " +
                    "C 9.22 7.2 -16.088 6.503 -14.043 25.517 " +
                    "C -12.048 39.53 -3.46 53.836 19.941 52.99 " +
                    "C 48.698 50.735 57.07 12.5 75 8.92 " +
                    `S ${162.06 * scaleLengthId} -6 ${185.11 * scaleLengthId} 23 ` +
                    `C ${181.44 * scaleLengthId} ${11.63 + 1 * scaleLengthId} ${157.88 * scaleLengthId} 0 ${126.41 * (1.2 - 0.2 * scaleLengthId) * (scaleLengthId)} 0 ` +
                    "S 81.12 4.86 57.6 6.89 " +
                    "Z")
                .attr("id", `Tp_seedStem${index}`)
                .style("fill", "#FFCA36")
                .style("stroke", "none");

            group1.append("circle")
                .attr("cx", 18)
                .attr("cy", 32)
                .attr("r", 25)
                .attr("id", `Tp_tooltipCircle${index}`)
                .attr("fill", "#000")
                .attr("opacity", "0")
                .on("mouseover", mouseover)
                .on("mousemove", mousemove)
                .on("mouseleave", mouseleave);

        } else {

            group1.append("path")
                .attr("d", "M 57.6 6.89 C 46 7.89 29.85 6.42 20.6 6.77 C 9.22 7.2 -41.583 4.467 -40.905 37.759 C -39.289 56.31 -25.731 82.914 10.897 81.111 C 57.311 75.993 52.579 16.323 75 8.92" +
                    `S ${162.06 * scaleLengthId} -6 ${185.11 * scaleLengthId} 23 ` +
                    `C ${181.44 * scaleLengthId} ${11.63 + 1 * scaleLengthId} ${157.88 * scaleLengthId} 0 ${126.41 * (1.2 - 0.2 * scaleLengthId) * (scaleLengthId)} 0 ` +
                    "S 81.12 4.86 57.6 6.89 " +
                    "Z")
                .attr("id", `Tp_seedStem${index}`)
                .style("fill", "#FFCA36")
                .style("stroke", "none");

            group1.append("circle")
                .attr("cx", 15)
                .attr("cy", 35)
                .attr("r", 30)
                .attr("id", `Tp_tooltipCircle${index}`)
                .attr("fill", "#000")
                .attr("opacity", "0")
                .on("mouseover", mouseover)
                .on("mousemove", mousemove)
                .on("mouseleave", mouseleave);
        }

        //定义情感的线性渐变
        {
            //目前：为每一个帖子定制一个defs：长度不同（x2不同）；末端颜色不同
            let emo_grad = tooltipDef.append("linearGradient")
                .attr("id", `Tp_emo_grad${index}`)
                .attr("gradientUnits", "userSpaceOnUse")
                .attr("x1", "57.6")
                .attr("y1", "6.89")
                .attr("x2", `${185.11 * scaleLengthId}`)
                .attr("y2", "23");

            //内容情感
            if (emo_neg_prob <= 0.5) {
                // console.log("a")
                let a = d3.rgb(129, 233, 59);	//积极一端的颜色
                let b = d3.rgb(255, 202, 54);	//橙色
                let linear = d3.scaleLinear()
                    .domain([0, 0.5])
                    .range([0, 1])
                let compute = d3.interpolate(a, b);
                let endColor = compute(linear(emo_neg_prob))

                let stop1 = emo_grad.append("stop")
                    .attr("id", `Tp_emo_grad_start${index}`)
                    .attr("offset", "0")
                    .style("stop-color", endColor);

                let stop2 = emo_grad.append("stop")
                    .attr("id", `Tp_emo_grad_end${index}`)
                    .attr("offset", "0.1")
                    .style("stop-opacity", "0")
                    .style("stop-color", endColor);

                d3.select(`#Tp_seedStem${index}`)
                    .style("fill", "url(#" + emo_grad.attr("id") + ")");

            } else {
                let a = d3.rgb(237, 28, 36);	//消极一端的颜色
                let b = d3.rgb(255, 202, 54);	//橙色
                let linear = d3.scaleLinear()
                    .domain([0.5, 1])
                    .range([0, 1])
                let compute = d3.interpolate(b, a);
                let endColor = compute(linear(emo_neg_prob))

                let stop1 = emo_grad.append("stop")
                    .attr("id", `Tp_emo_grad_start${index}`)
                    .attr("offset", "0")
                    .style("stop-color", endColor);

                let stop2 = emo_grad.append("stop")
                    .attr("id", `Tp_emo_grad_end${index}`)
                    .attr("offset", "0.1")
                    .style("stop-opacity", "0")
                    .style("stop-color", endColor);

                d3.select(`#Tp_seedStem${index}`)
                    .style("fill", "url(#" + emo_grad.attr("id") + ")");

            }
        }


        if (isVlevelOn) {
            // 微博等级
            if (vlevel == "normal") {
                group1.append("circle")
                    .attr("cx", "8")
                    .attr("cy", "-5")
                    .attr("r", "10")
                    .attr("stroke", "none")
                    .attr("fill", "#FFCA36")
                    .attr("opacity", "0.3")
            } else if (vlevel == "yellow") {
                group1.append("circle")
                    .attr("cx", "8")
                    .attr("cy", "-5")
                    .attr("r", "10")
                    .attr("stroke", "none")
                    .attr("fill", "#FFCA36")
                    .attr("opacity", "0.5")
                group1.append("circle")
                    .attr("cx", "32")
                    .attr("cy", "-8")
                    .attr("r", "10")
                    .attr("stroke", "none")
                    .attr("fill", "#FFCA36")
                    .attr("opacity", "0.3")
            } else if (vlevel == "gold") {
                group1.append("circle")
                    .attr("cx", "8")
                    .attr("cy", "-5")
                    .attr("r", "10")
                    .attr("stroke", "none")
                    .attr("fill", "#FFCA36")
                    .attr("opacity", "0.8")
                group1.append("circle")
                    .attr("cx", "32")
                    .attr("cy", "-8")
                    .attr("r", "10")
                    .attr("stroke", "none")
                    .attr("fill", "#FFCA36")
                    .attr("opacity", "0.5")
                group1.append("circle")
                    .attr("cx", "56")
                    .attr("cy", "-8")
                    .attr("r", "10")
                    .attr("stroke", "none")
                    .attr("fill", "#FFCA36")
                    .attr("opacity", "0.3")
            } else {
                group1.append("circle")
                    .attr("cx", "8")
                    .attr("cy", "-5")
                    .attr("r", "10")
                    .attr("stroke", "none")
                    .attr("fill", "#3694ff")
                    .attr("opacity", "0.8")
            }
        }

    }


</script>


<script>
    var switchMapTo = function (n) {
        if (n == 0) {
            d3.select("#switchMapBtn0").attr("class", "buttonUnSelected normalContent");
            d3.select("#switchMapBtn1").attr("class", "buttonSelected normalContent");

            d3.select("#mapSC2")
                .transition()
                .attr("opacity", 0)
                .duration(800);

            d3.select("#mapSC3")
                .transition()
                .attr("opacity", 1)
                .duration(800);

            d3.select("#switchMapQ0")
                .transition()
                .style("opacity", 0)
                .duration(400);

            d3.select("#switchMapQ1")
                .transition()
                .style("opacity", 1)
                .duration(800)
                .delay(200);

            d3.select("#mapSC2legend")
                .transition()
                .style("opacity", 0)
                .duration(400);

            d3.select("#mapSC3legend")
                .transition()
                .style("opacity", 1)
                .duration(800);

        } else {
            d3.select("#switchMapBtn0").attr("class", "buttonSelected normalContent");
            d3.select("#switchMapBtn1").attr("class", "buttonUnSelected normalContent");

            d3.select("#mapSC2")
                .transition()
                .attr("opacity", 1)
                .duration(800);

            d3.select("#mapSC3")
                .transition()
                .attr("opacity", 0)
                .duration(800);

            d3.select("#switchMapQ0")
                .transition()
                .style("opacity", 1)
                .duration(800)
                .delay(200);


            d3.select("#switchMapQ1")
                .transition()
                .style("opacity", 0)
                .duration(400);

            d3.select("#mapSC2legend")
                .transition()
                .style("opacity", 1)
                .duration(800);

            d3.select("#mapSC3legend")
                .transition()
                .style("opacity", 0)
                .duration(400);
        }
    }

    var questionMap = function (n, isShow) {
        // if(n == 0 && isShow)
        // {
        //     d3.select(".mapSC2legend")
        //         .transition()
        //         .attr("opacity", 1)
        //         .duration(400);
        // }else if(n == 0 && !isShow)
        // {
        //     d3.select(".mapSC2legend")
        //         .transition()
        //         .attr("opacity", 0)
        //         .duration(400);
        // }
    }
</script>

<script>
    var heiScaleRatio = 1 / 886 * window.innerHeight;

    var widScaleRatio = 1 / 1728 * window.innerWidth;

    var addSemi = function (num) {
        let numStr = num.toString();
        let cnt = 0;
        let resLst = [];

        for (let i = numStr.length - 1; i >= 0; i--) {

            resLst.push(numStr[i]);
            cnt += 1;
            if (cnt % 3 == 0) {
                cnt = 0;
                resLst.push(',');
            }
        }

        let res = "";
        for (let i = resLst.length - 1; i >= 0; i--) {
            res += resLst[i];
        }
        if (res[0] == ",")
            res = res.substring(1,);
        return res;
    }

    const $setJumpNumber = (startNum, targetNum, time = 1, selector) => {

        let dom = document.querySelector(selector);

        let originNum = startNum;

        let stepNum = 0;

        let timeNum = time;

        dom.innerHTML = startNum;

        let timeId = setInterval(() => {

            if (originNum < targetNum) {

                timeNum -= 0.001;

                let strNum = originNum.toString();

                // 数字比较少的时候直接用 + 1; 数字很大直接 +1 要很久才能调到最对应的数字，所有后三位数随机跳动的方式进行模拟生成

                if (targetNum.toString().length <= 6) {

                    stepNum += 10; // 这样才可以实现越跳越快的效果

                    originNum = originNum + stepNum;

                    dom.innerHTML = addSemi(originNum);

                } else if (targetNum.toString().length >= 12) {

                    stepNum += 1000000; // 这样才可以实现越跳越快的效果

                    originNum = originNum + stepNum;

                    dom.innerHTML = addSemi(strNum.substring(0, strNum.length - 6) + Math.floor(Math.random() * 10) + Math.floor(Math.random() * 10) + Math.floor(Math.random() * 10) + Math.floor(Math.random() * 10) + Math.floor(Math.random() * 10) + Math.floor(Math.random() * 10));

                } else {
                    stepNum += 200; // 这样才可以实现越跳越快的效果

                    originNum = originNum + stepNum;

                    dom.innerHTML = addSemi(strNum.substring(0, strNum.length - 6) + Math.floor(Math.random() * 10) + Math.floor(Math.random() * 10) + Math.floor(Math.random() * 10) + Math.floor(Math.random() * 10) + Math.floor(Math.random() * 10) + Math.floor(Math.random() * 10));

                }

            } else {

                dom.innerHTML = addSemi(targetNum);

                clearInterval(timeId);

            }

        }, timeNum);

    };
    // var video = document.getElementById("coverVideo");
    // video.play();
    $setJumpNumber(1000000, 118200000000, 1, "#coverNoViews");
    $setJumpNumber(200000, 11200000, 1, "#coverNoDiscussions");
    $setJumpNumber(1000, 271000, 1, "#coverNoOriginals");
</script>

<script>

    var svg1 = d3.select("#svg1")
        .attr("width", "120%")
        .attr("height", 0.9 * window.innerHeight);

    var defs = svg1.append("defs");


    //添加post图片
    {
        svg1
            .append("image")
            .attr("id", "postDataImg")
            .attr("x", 30)
            .attr("y", 200 * heiScaleRatio)
            .attr("width", 500 * widScaleRatio)
            .attr("xlink:href", "img/posts.png");
    }

    //

    //情感api
    {
        var emotionGroup = svg1.append("g")
            .attr("id", "emotionGroup")
            .style("opacity", "0");

        emotionGroup
            .append("image")
            .attr("x", 550 - (430 * (1 - widScaleRatio)) - 90 * (1 - widScaleRatio))
            .attr("y", 370 * heiScaleRatio)
            .attr("width", 30 * widScaleRatio)
            .attr("xlink:href", "img/smile.svg");

        emotionGroup
            .append("image")
            .attr("x", 50)
            .attr("y", 370 * heiScaleRatio)
            .attr("width", 30 * widScaleRatio)
            .attr("xlink:href", "img/sad.svg");

        emotionGroup
            .append("rect")
            .attr("x", 100 - 60 * (1 - widScaleRatio))
            .attr("y", 373 * heiScaleRatio)
            .attr("width", 430 * widScaleRatio)
            .attr("height", 24 * heiScaleRatio)
            .attr("fill", "#1f1f1f");

        {
            //色块渐变
            var grad45 = defs.append("linearGradient")
                .attr("id", "grad45")
                .attr("gradientUnits", "userSpaceOnUse");

            grad45
                .append("stop")
                .attr("offset", "0")
                .style("stop-color", "#ffc000")
                .style("stop-opacity", "1");

            grad45
                .append("stop")
                .attr("offset", "1")
                .style("stop-color", "#da7d1e")
                .style("stop-opacity", "1");

            //白色渐变
            var gradWhite = defs.append("linearGradient")
                .attr("x1", "315")
                .attr("y1", `${353 * heiScaleRatio}`)
                .attr("x2", "315")
                .attr("y2", `${417 * heiScaleRatio}`)
                .attr("id", "gradWhite")
                .attr("gradientUnits", "userSpaceOnUse");

            gradWhite
                .append("stop")
                .append("stop")
                .attr("offset", "0")
                .style("stop-color", "#ffffff")
                .style("stop-opacity", "0");

            gradWhite
                .append("stop")
                .attr("offset", "0.5")
                .style("stop-color", "#ffffff")
                .style("stop-opacity", ".7");

            gradWhite
                .append("stop")
                .attr("offset", "1")
                .style("stop-color", "#ffffff")
                .style("stop-opacity", "0");


        }

        emotionGroup
            .append("rect")
            .attr("id", "emotionRect")
            .attr("x", 100 - 60 * (1 - widScaleRatio))
            .attr("y", 373 * heiScaleRatio)
            .attr("width", 0)
            .attr("height", 24 * heiScaleRatio)
            .attr("fill", "url(#grad45)");

        //中间虚线
        emotionGroup
            .append("line")
            .attr("id", "emotionRect")
            .attr("x1", (100 - 60 * (1 - widScaleRatio)) + (430 * widScaleRatio) / 2)
            .attr("y1", `${(303 - 20 + 70) * heiScaleRatio}`)
            .attr("x2", (100 - 60 * (1 - widScaleRatio)) + (430 * widScaleRatio) / 2)
            .attr("y2", `${(327 + 20 + 70) * heiScaleRatio}`)
            .attr("stroke-dasharray", "8, 8")
            .attr("stroke-linecap", "round")
            .attr("stroke-width", "2")
            .attr("stroke", "url(#gradWhite)");


        emotionGroup
            .append('text')
            .attr("x", 50)
            .attr("y", (360 + 70) * heiScaleRatio)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'noto-sans, sans-serif')
            .style('fill', 'rgba(255,255,255,0.7)')
            .text("negative")

        emotionGroup
            .append('text')
            .attr("x", 550 - (430 * (1 - widScaleRatio)) - 150 * (1 - widScaleRatio) - 25 * widScaleRatio)
            .attr("y", (360 + 70) * heiScaleRatio)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'noto-sans, sans-serif')
            .style('fill', 'rgba(255,255,255,0.7)')
            .text("positive")

        emotionGroup
            .append('text')
            .attr("x", (100 - 60 * (1 - widScaleRatio)) + (430 * widScaleRatio) / 2 - 13 * widScaleRatio)
            .attr("y", (360 + 70) * heiScaleRatio)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'noto-sans, sans-serif')
            .style('fill', 'rgba(255,255,255,0.7)')
            .text("0.5")

    }

    //添加hashtag图片
    {
        svg1
            .append("image")
            .attr("id", "hashtagDataImg")
            .attr("x", 30)
            .attr("y", 300 * heiScaleRatio)
            .attr("width", 500 * widScaleRatio)
            .attr("opacity", "0")
            .attr("xlink:href", "img/hashtags.png");
    }

    //添加hashtag数量随时间分布
    {
        var hashtagGraph = svg1.append("g")
            .attr("id", "hashtagDistributionGraph")
            .attr("opacity", 0)
            .attr("transform", `translate(${100},${150})`);

        // set the dimensions and margins of the graph
        const margin = {
                top: 10 * heiScaleRatio,
                right: 30 * widScaleRatio,
                bottom: 90 * heiScaleRatio,
                left: 40 * widScaleRatio
            },
            width = (500 - margin.left - margin.right) * widScaleRatio,
            height = (450 - margin.top - margin.bottom) * heiScaleRatio;

        // Parse the Data
        var hashtagDisData;
        d3.csv("csv/hashtagDis.csv").then(function (data) {
            hashtagDisData = data;
            // X axis
            const x = d3.scaleBand()
                .range([0, width])
                .domain(data.map(d => d.Date))
                .padding(0.2);

            hashtagGraph.append("g")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(x))
                .selectAll("text")
                .attr("class", "xDateTxt")
                .attr("transform", "translate(-10,0)rotate(-45)")
                .style('font-weight', 300)
                .style("font-size", ".4rem")
                .style('font-family', 'noto-sans, sans-serif')
                .style('fill', 'rgba(255,255,255,0.7)')
                .style("text-anchor", "end");

            d3.selectAll(".xDateTxt")
                .attr("opacity", function (d, i) {
                    if (i == 0 || i == 2 || i == 3 || i == 6 || i == 9 || i == 16 || i == 18)
                        return 1
                    return .2;
                })

            // Add Y axis
            // const y = d3.scaleLinear()
            //     .domain([0, 50])
            //     .range([ height, 0]);
            // hashtagGraph.append("g")
            //     .call(d3.axisLeft(y));

            // Bars
            hashtagGraph.selectAll("mybar")
                .data(data)
                .join("rect")
                .attr("x", d => (x(d.Date)))
                .attr("width", x.bandwidth())
                // .attr("class", "rectGrad45")
                .attr("fill", "url(#grad45)")
                // no bar at the beginning thus:
                .attr("height", d => height - y(0)) // always equal to 0
                .attr("y", d => y(0))
            console.log(data)


            //添加图标
            const dates = ["0", "2", "6", "9", "16", "18"];
            hashtagGraph.selectAll("arrIcon")
                .data(dates)
                .join("image")
                .attr("class", "dateIcon")
                .attr("opacity", "0")
                .attr("x", d => x(data[d].Date))
                .attr("y", d => y(data[d].Value) - 30 + 30 * (1 - widScaleRatio))
                .attr("width", x.bandwidth())
                .attr("xlink:href", "img/arrIcon.svg");

            hashtagGraph.append("image")
                .attr("x", x(data[0].Date)) //第一天column坐标
                .attr("y", 30)
                .attr("width", x.bandwidth())
                .attr("opacity", ".8")
                .attr("xlink:href", "img/arrIcon.svg");


            hashtagGraph.append("text")
                .attr("x", x(data[0].Date) + 2 * x.bandwidth()) //第一天column坐标
                .attr("y", 30 + .7 * 24)
                .style('font-weight', 300)
                .style("font-size", ".7rem")
                .style('font-family', 'noto-sans, sans-serif')
                .style('fill', 'rgba(255,255,255,0.7)')
                .text("official report release date");

            //小字注释
            {
                const textBeizhu = hashtagGraph.append("g")
                    .attr("opacity", "0")
                    .attr("class", "dateIcon");

                textBeizhu.append("text")
                    .attr("x", x(data[3].Date) + x.bandwidth()) //第一天column坐标
                    .attr("y", (30 + .7 * 24 + 140 - 6) * heiScaleRatio)
                    .style('font-weight', 300)
                    .style("font-size", ".5rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.5)')
                    .text("report of Jan 30 was released late at night ");

                //绘制拉出来的指引线
                textBeizhu.append("line")
                    .attr("x1", x(data[3].Date) + x.bandwidth() / 2)
                    .attr("y1", (180) * heiScaleRatio)
                    .attr("x2", x(data[3].Date) + x.bandwidth() / 2)
                    .attr("y2", y(data[3].Value) - 10 * heiScaleRatio)
                    .attr("stroke", "#ffc000")
                    .attr("opacity", ".5")
                    .attr("stroke-dasharray", "8, 8");

                //圆1
                textBeizhu.append("circle")
                    .attr("cx", x(data[3].Date) + x.bandwidth() / 2)
                    .attr("cy", (180) * heiScaleRatio)
                    .attr("r", 2)
                    .attr("fill", "#ffc000")
                    .attr("opacity", ".6");

                //圆2
                textBeizhu.append("circle")
                    .attr("cx", x(data[3].Date) + x.bandwidth() / 2)
                    .attr("cy", y(data[3].Value) - 10 * heiScaleRatio)
                    .attr("r", 2)
                    .attr("stroke", "#ffc000")
                    .attr("opacity", ".6");
            }

            //刻度尺
            {
                //渐变
                //色块渐变
                const gradLine = defs.append("linearGradient")
                    .attr("x1", x(data[20].Date) + 2 * x.bandwidth())
                    .attr("y1", y(50))
                    .attr("x2", x(data[20].Date) - 10 * x.bandwidth())
                    .attr("y2", y(50))
                    .attr("id", "gradLine")
                    .attr("gradientUnits", "userSpaceOnUse");
                const kedu = hashtagGraph.append("g")
                    .attr("opacity", "1")
                    .attr("class", "dateIcon");

                gradLine
                    .append("stop")
                    .attr("offset", "0")
                    .style("stop-color", "#ffc000")
                    .style("stop-opacity", ".7");

                gradLine
                    .append("stop")
                    .attr("offset", "1")
                    .style("stop-color", "#ffc000")
                    .style("stop-opacity", "0");

                const gradLine2 = defs.append("linearGradient")
                    .attr("x1", x(data[20].Date) + 2 * x.bandwidth())
                    .attr("y1", y(50))
                    .attr("x2", x(data[20].Date) - 6 * x.bandwidth())
                    .attr("y2", y(50))
                    .attr("id", "gradLine2")
                    .attr("gradientUnits", "userSpaceOnUse");

                gradLine2
                    .append("stop")
                    .attr("offset", "0")
                    .style("stop-color", "#ffc000")
                    .style("stop-opacity", ".7");

                gradLine2
                    .append("stop")
                    .attr("offset", "1")
                    .style("stop-color", "#ffc000")
                    .style("stop-opacity", "0");

                kedu.append("line")
                    .attr("x1", x(data[20].Date) + 2 * x.bandwidth()) //第一天column坐标
                    .attr("y1", y(50))
                    .attr("x2", x(data[20].Date) - 10 * x.bandwidth()) //第一天column坐标
                    .attr("y2", y(50))
                    .style('stroke', 'url(#gradLine)');

                kedu.append("line")
                    .attr("x1", x(data[20].Date) + 2 * x.bandwidth()) //第一天column坐标
                    .attr("y1", (y(50) + 350) / 2)
                    .attr("x2", x(data[20].Date) - 6 * x.bandwidth()) //第一天column坐标
                    .attr("y2", (y(50) + 350) / 2)
                    .style('stroke', 'url(#gradLine2)');


                kedu.append("text")
                    .attr("x", x(data[20].Date) + 3 * x.bandwidth()) //第一天column坐标
                    .attr("y", 350)
                    .style('font-weight', 300)
                    .style("font-size", ".7rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.7)')
                    .text("0");

                kedu.append("text")
                    .attr("x", x(data[20].Date) + 3 * x.bandwidth()) //第一天column坐标
                    .attr("y", y(50) + 0.7 * 12)
                    .style('font-weight', 300)
                    .style("font-size", ".7rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.7)')
                    .text("50 (no. of hashtags)");

                kedu.append("text")
                    .attr("x", x(data[20].Date) + 3 * x.bandwidth()) //第一天column坐标
                    .attr("y", (y(50) + 350) / 2 + 0.7 * 12)
                    .style('font-weight', 300)
                    .style("font-size", ".7rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.7)')
                    .text("25");


            }


        })

        // hashtagGraph.append("image")


    }

    //添加post分布
    {
        var postCat = svg1.append("g")
            .attr("transform", `translate( ${60 * widScaleRatio}, ${200 * heiScaleRatio})`)
            .attr("id", "postCat")
            .attr("opacity", 0);

        // postCat.append("image")
        //     .attr("x", 30)
        //     .attr("y", 200 * heiScaleRatio)
        //     .attr("width", 300 * widScaleRatio)
        //     .attr("xlink:href", "img/postNum.svg");

        for (let i = 0; i < 9; i++) {
            let group = postCat.append("g")
                .attr("transform", `translate( ${0}, ${i * 40}), scale(0.5)`);

            d3.xml("img/postNum.svg")
                .then(data => {
                    group.node().append(data.documentElement)
                    const names = ["related to report 1", "related to report 2",
                        "related to report 3", "related to report 4", "related to report 5",
                        "related to report 6", "reflection", "other", "contain no hashtags"];
                    const dist = [250, 250, 250, 250, 250, 250, 315, 340, 240]

                    group.append("text")
                        .attr("x", dist[i]) //第一天column坐标
                        .attr("y", 24 * 0.7 / 2 + 20)
                        .style('font-weight', 300)
                        .style("font-size", "1.4rem")
                        .style('font-family', 'noto-sans, sans-serif')
                        .style('fill', 'rgba(255,255,255,.7)')
                        .text(names[i]);
                });


        }


    }

    //添加victim图片
    {
        svg1
            .append("image")
            .attr("id", "victimImg")
            .attr("x", 30)
            .attr("y", 300 * heiScaleRatio)
            .attr("width", 500 * widScaleRatio)
            .attr("opacity", "0")
            .attr("xlink:href", "img/chains.svg");
    }


</script>


<!--scroll magic动画-->
<script>
    var controller = new ScrollMagic.Controller();

    //svg固定
    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#trigger1",
        duration: document.getElementById('victimExit').getBoundingClientRect().top - document.getElementById('trigger1').getBoundingClientRect().top - 500 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: 16 * 24 * heiScaleRatio
    })
        .setPin("#divFixed")  // 种子相对页面静止不动
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    //post图片不动
    var divStayedScene2 = new ScrollMagic.Scene({
        triggerElement: "#postTriggerExit",
        duration: 4 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: 5 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#postDataImg").style("opacity", 1 - event.progress);
        })  // 种子相对页面静止不动

        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    //emotion固定
    var divStayedScene3 = new ScrollMagic.Scene({
        triggerElement: "#emotionTriggerEnter",
        duration: 4 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: -4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {

            d3.select("#emotionGroup").style("opacity", event.progress);
        })  // 种子相对页面静止不动

        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    //emotion进度条
    var divStayedScene4 = new ScrollMagic.Scene({
        triggerElement: "#emotionTriggerEnter",
        duration: 4 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: 0 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {

            d3.select("#emotionRect").style("width", 300 * widScaleRatio * event.progress);
        })

        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    //emotion退场
    var divStayedScene5 = new ScrollMagic.Scene({
        triggerElement: "#emotionTriggerExit",
        duration: 4 * 24 * heiScaleRatio,
        offset: 4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {

            d3.select("#emotionGroup").style("opacity", 1 - event.progress);
        })

        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    //hashtag进场
    var divStayedScene6 = new ScrollMagic.Scene({
        triggerElement: "#hashtagTriggerEnter",
        duration: 4 * 24 * heiScaleRatio,
        offset: -4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {

            d3.select("#hashtagDataImg").style("opacity", event.progress);
        })

        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    //hashtag退场
    var divStayedScene6 = new ScrollMagic.Scene({
        triggerElement: "#hashtagTriggerExit",
        duration: 4 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: 4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#hashtagDataImg").style("opacity", 1 - event.progress);
        })  // 种子相对页面静止不动

        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    const margin = {
            top: 10 * heiScaleRatio,
            right: 30 * widScaleRatio,
            bottom: 90 * heiScaleRatio,
            left: 40 * widScaleRatio
        },
        width = (500 - margin.left - margin.right) * widScaleRatio,
        height = (450 - margin.top - margin.bottom) * heiScaleRatio;

    const y = d3.scaleLinear()
        .domain([0, 50])
        .range([height, 0]);

    //hashtagGraph进场
    var divStayedScene6 = new ScrollMagic.Scene({
        triggerElement: "#hashtagGraphEnter",
        duration: 4 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: -4 * 24 * heiScaleRatio
    })
        .on("start", function (event) {
// Add Y axis

            hashtagGraph.selectAll("rect")
                .transition()
                .duration(600)
                .attr("y", d => y(d.Value))
                .attr("height", d => height - y(d.Value))
                .delay((d, i) => {
                    return i * 100
                })

            hashtagGraph.selectAll(".dateIcon")
                .transition()
                .duration(800)
                .attr("opacity", 1)
                .delay((d, i) => {
                    return i * 400
                })

        })
        .on("progress", function (event) {
            d3.select("#hashtagDistributionGraph").style("opacity", event.progress);
        })

        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene6 = new ScrollMagic.Scene({
        triggerElement: "#hashtagGraphExit",
        duration: 4 * 24 * heiScaleRatio,
        offset: 4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#hashtagDistributionGraph").style("opacity", 1 - event.progress);
        })

        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene6 = new ScrollMagic.Scene({
        triggerElement: "#postCatEnter",
        duration: 4 * 24 * heiScaleRatio,
        offset: -4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#postCat").style("opacity", event.progress);
        })
        .on("start", function (event) {
            const postNum = [1558, 36, 271, 378, 447, 278, 48, 473, 1236];
            const x = d3.scaleLinear()
                .domain([0, 1600])
                .range([0, 800]);

            d3.selectAll(".postRectMove")
                .transition()
                .duration(600)
                .attr("width", function (d, i) {
                    return x(postNum[i]);
                })
                .delay((d, i) => {
                    return i * 100
                })
        })

        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene6 = new ScrollMagic.Scene({
        triggerElement: "#postCatExit",
        duration: 4 * 24 * heiScaleRatio,
        offset: 4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#postCat").style("opacity", 1 - event.progress);
        })



        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene6 = new ScrollMagic.Scene({
        triggerElement: "#victimEnter",
        duration: 4 * 24 * heiScaleRatio,
        offset: -4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#victimImg").style("opacity", event.progress);
        })

        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene6 = new ScrollMagic.Scene({
        triggerElement: "#victimExit",
        duration: 4 * 24 * heiScaleRatio,
        offset: 4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#victimImg").style("opacity", 1 - event.progress);
        })

        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);


</script>

<!--目录scroll magic-->
<script>
    var cataTopDis = d3.scaleLinear()
        .domain([1, 6])
        .range([22, 268]);
    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#designWithDataCatalogEnter",
        duration: 4 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: 0 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#catalog")
                .style("opacity", event.progress);

        })

        .on("start", function (event) {
            d3.selectAll(".cataTxt")
                .transition()
                .style("opacity", "0.3")
                .style("font-weight", "300")
                .duration(800);

            d3.select("#designWithDataCataTxt")
                .transition()
                .style("opacity", "0.9")
                .style("font-weight", "500")
                .duration(800);

            d3.select("#catlogRect")
                .transition()
                .style("top", `${cataTopDis(1)}px`)
                .duration(800);

        })
        // .addIndicators({name: "ddd (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#designWithDataCatalogExit",
        duration: 0 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: -12 * 24 * heiScaleRatio
    })
        .on("start", function (event) {
            d3.selectAll(".cataTxt")
                .transition()
                .style("opacity", "0.3")
                .style("font-weight", "300")
                .duration(800);

            d3.select("#designWithDataCataTxt")
                .transition()
                .style("opacity", "0.9")
                .style("font-weight", "500")
                .duration(800);

            d3.select("#catlogRect")
                .transition()
                .style("top", `${cataTopDis(1)}px`)
                .duration(800);

        })
        // .addIndicators({name: "xx (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#designQuestionsCatalogEnter",
        duration: 0 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: -4 * 24 * heiScaleRatio
    })
        .on("start", function (event) {
            d3.selectAll(".cataTxt")
                .transition()
                .style("opacity", "0.3")
                .style("font-weight", "300")
                .duration(800);

            d3.select("#designQuestionsCataTxt")
                .transition()
                .style("opacity", "0.9")
                .style("font-weight", "500")
                .duration(800);

            d3.select("#catlogRect")
                .transition()
                .style("top", `${cataTopDis(2)}px`)
                .duration(800);
        })
        // .addIndicators({name: "ddd (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#designQuestionsCatalogExit",
        duration: 0 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: -12 * 24 * heiScaleRatio
    })
        .on("start", function (event) {
            d3.selectAll(".cataTxt")
                .transition()
                .style("opacity", "0.3")
                .style("font-weight", "300")
                .duration(800);

            d3.select("#designQuestionsCataTxt")
                .transition()
                .style("opacity", "0.9")
                .style("font-weight", "500")
                .duration(800);

            d3.select("#catlogRect")
                .transition()
                .style("top", `${cataTopDis(2)}px`)
                .duration(800);
        })
        // .addIndicators({name: "xx (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#dataCollectionCatalogEnter",
        duration: 0 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: -4 * 24 * heiScaleRatio
    })
        .on("start", function (event) {
            d3.selectAll(".cataTxt")
                .transition()
                .style("opacity", "0.3")
                .style("font-weight", "300")
                .duration(800);

            d3.select("#dataCollectionCataTxt")
                .transition()
                .style("opacity", "0.9")
                .style("font-weight", "500")
                .duration(800);

            d3.select("#catlogRect")
                .transition()
                .style("top", `${cataTopDis(3)}px`)
                .duration(800);
        })
        // .addIndicators({name: "xx (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#dataCollectionCatalogExit",
        duration: 0 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: -16 * 24 * heiScaleRatio
    })
        .on("start", function (event) {
            d3.selectAll(".cataTxt")
                .transition()
                .style("opacity", "0.3")
                .style("font-weight", "300")
                .duration(800);

            d3.select("#dataCollectionCataTxt")
                .transition()
                .style("opacity", "0.9")
                .style("font-weight", "500")
                .duration(800);

            d3.select("#catlogRect")
                .transition()
                .style("top", `${cataTopDis(3)}px`)
                .duration(800);
        })
        // .addIndicators({name: "xx (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#designProcessCatalogEnter",
        duration: 0 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: -8 * 24 * heiScaleRatio
    })
        .on("start", function (event) {
            d3.selectAll(".cataTxt")
                .transition()
                .style("opacity", "0.3")
                .style("font-weight", "300")
                .duration(800);

            d3.select("#designProcessCataTxt")
                .transition()
                .style("opacity", "0.9")
                .style("font-weight", "500")
                .duration(800);

            d3.select("#catlogRect")
                .transition()
                .style("top", `${cataTopDis(4)}px`)
                .duration(800);
        })
        // .addIndicators({name: "xx (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#designProcessCatalogExit",
        duration: 0 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: -8 * 24 * heiScaleRatio
    })
        .on("start", function (event) {
            d3.selectAll(".cataTxt")
                .transition()
                .style("opacity", "0.3")
                .style("font-weight", "300")
                .duration(800);

            d3.select("#designProcessCataTxt")
                .transition()
                .style("opacity", "0.9")
                .style("font-weight", "500")
                .duration(800);

            d3.select("#catlogRect")
                .transition()
                .style("top", `${cataTopDis(4)}px`)
                .duration(800);
        })
        // .addIndicators({name: "xx (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#otherChallengesCatalogEnter",
        duration: 0 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: -4 * 24 * heiScaleRatio
    })
        .on("start", function (event) {
            d3.selectAll(".cataTxt")
                .transition()
                .style("opacity", "0.3")
                .style("font-weight", "300")
                .duration(800);

            d3.select("#otherChallengesCataTxt")
                .transition()
                .style("opacity", "0.9")
                .style("font-weight", "500")
                .duration(800);

            d3.select("#catlogRect")
                .transition()
                .style("top", `${cataTopDis(5)}px`)
                .duration(800);
        })
        // .addIndicators({name: "xx (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#otherChallengesCatalogExit",
        duration: 0 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: -8 * 24 * heiScaleRatio
    })
        .on("start", function (event) {
            d3.selectAll(".cataTxt")
                .transition()
                .style("opacity", "0.3")
                .style("font-weight", "300")
                .duration(800);

            d3.select("#otherChallengesCataTxt")
                .transition()
                .style("opacity", "0.9")
                .style("font-weight", "500")
                .duration(800);

            d3.select("#catlogRect")
                .transition()
                .style("top", `${cataTopDis(5)}px`)
                .duration(800);
        })
        // .addIndicators({name: "xx (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#reflectionCatalogEnter",
        duration: 0 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: -4 * 24 * heiScaleRatio
    })
        .on("start", function (event) {
            d3.selectAll(".cataTxt")
                .transition()
                .style("opacity", "0.3")
                .style("font-weight", "300")
                .duration(800);

            d3.select("#reflectionCataTxt")
                .transition()
                .style("opacity", "0.9")
                .style("font-weight", "500")
                .duration(800);

            d3.select("#catlogRect")
                .transition()
                .style("top", `${cataTopDis(6)}px`)
                .duration(800);
        })
        // .addIndicators({name: "xx (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);


</script>

<!--目录响应点击跳转-->
<script>
    var cataJumpTo = function (part){
        const dist = [8*24, 8*24, 6*24, 10*24, 6*24, 2*24,];
        if(part == 1){
            window.scrollTo({
                top: (document.documentElement.scrollTop || document.body.scrollTop) + document.getElementById('designWithDataCatalogEnter').getBoundingClientRect().top - dist[0]*heiScaleRatio,
                behavior: "smooth"
            });
        }
        else if(part == 2){
            window.scrollTo({
                top: (document.documentElement.scrollTop || document.body.scrollTop) + document.getElementById('designQuestionsCatalogEnter').getBoundingClientRect().top - dist[1]*heiScaleRatio,
                behavior: "smooth"
            });
        }else if(part == 3){
            window.scrollTo({
                top: (document.documentElement.scrollTop || document.body.scrollTop) + document.getElementById('dataCollectionCatalogEnter').getBoundingClientRect().top - dist[2]*heiScaleRatio,
                behavior: "smooth"
            });
        }else if(part == 4){
            window.scrollTo({
                top: (document.documentElement.scrollTop || document.body.scrollTop) + document.getElementById('designProcessCatalogEnter').getBoundingClientRect().top - dist[3]*heiScaleRatio,
                behavior: "smooth"
            });
        }else if(part == 5){
            window.scrollTo({
                top: (document.documentElement.scrollTop || document.body.scrollTop) + document.getElementById('otherChallengesCatalogEnter').getBoundingClientRect().top - dist[4]*heiScaleRatio,
                behavior: "smooth"
            });
        }else if(part == 6){
            window.scrollTo({
                top: (document.documentElement.scrollTop || document.body.scrollTop) + document.getElementById('reflectionCatalogEnter').getBoundingClientRect().top - dist[5]*heiScaleRatio,
                behavior: "smooth"
            });
        }
    }
</script>

<!--wind card svg-->
<script>
    var windSvg = d3.select("#windCardSvg")
        .attr("width", "100%")
        .attr("height", 0.35 * window.innerHeight);
    windSvg
        .append("image")
        .attr("id", "windCardImg")
        .attr("x", 20)
        .attr("y", 0)
        .attr("opacity", 1)
        .attr("width", 450 * widScaleRatio)
        .attr("xlink:href", "img/windglyph.png");

    windSvg
        .append("image")
        .attr("id", "windCardSeedPos")
        .attr("x", 40)
        .attr("y", 0)
        .attr("opacity", 0)
        .attr("width", 450 * widScaleRatio)
        .attr("xlink:href", "img/seedPos2.png");
</script>

<!--wind card scroll magic-->
<script>
    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#quoteExit",
        duration: 22 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: 12 * 24 * heiScaleRatio
    })
        .setPin("#windCard")

        // .addIndicators({name: "ddd (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#quoteExit",
        duration: 6 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: 16 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#windCardLine1")
                .style("opacity", 1 - event.progress)

            d3.select("#windCardLine2")
                .style("opacity", 1 - event.progress)

            const xScale = d3.scaleLinear()
                .domain([0, 1])
                .range([0, -400]);

            const yScale = d3.scaleLinear()
                .domain([0, 1])
                .range([0, -190]);

            d3.select("#windCardImg")
                .attr("transform", `translate(${xScale(event.progress)}, ${yScale(event.progress)}), scale(${1 + event.progress})`)
                .attr("opacity", 1 - event.progress)
        })
        // .addIndicators({name: "ddd (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#quoteExit",
        duration: 1 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: 22 * 24 * heiScaleRatio
    })
        .on("start", function (event) {
            d3.select("#windCardLine1")
                .text("This is the result of visualizing public voices on Weibo")
            d3.select("#windCardLine2")
                .text("And we saw wisps of red, angry wind")
        })
        .on("end", function (event) {
            d3.select("#windCardLine1")
                .text("Inside the wind...")
            d3.select("#windCardLine2")
                .text("there are samara seeds carried with it")
        })

        // .addIndicators({name: "ddd (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#quoteExit",
        duration: 6 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: 23 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#windCardLine1")
                .style("opacity", event.progress)

            d3.select("#windCardLine2")
                .style("opacity", event.progress)

            d3.select("#windCardSeedPos")
                .attr("opacity", event.progress)
        })

        // .addIndicators({name: "ddd (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);


</script>

<!--d3资源加载svg2-->
<script>
    var svg2 = d3.select("#svg2")
        .attr("width", "120%")
        .attr("height", 0.9 * window.innerHeight);

    var defs2 = svg2.append("defs");

    //seed attribute动画显示
    {
        const seedAttrGroup = svg2.append("g")
            .attr("id", "seedAttrGroup")
            .attr("transform", `translate(${0}, ${60})`);
        var seedAttrGroupIndY1 = 60;
        var seedAttrGroupIndY2 = 180;

        const groupIconsLeft = seedAttrGroup.append("g")
            .attr("id", "seedQLeft")
            .attr("transform", `translate(${0}, ${100})`);

        const groupIconsRight = seedAttrGroup.append("g")
            .attr("id", "seedQRight")
            .attr("transform", `translate(${70}, ${100})`);

        const svgArr = ["like", "retweet", "followers", "comments", "accountLv", "name"]
        const names = ["no. of likes", "no. of retweets", "no. of followers", "no. of comments", "account type", "name"]
        const imp = [2.5, 2.5, 2.5, 2, 2, 0.5];

        const svgArr2 = ["time", "hashtagGroups", "content", "senti"]
        const names2 = ["post time", "hashtag group", "content", "average sentiment"]
        const imp2 = [3, 3, 2, 1.5];
        var indXSeedQ1 = 250;
        // var indXSeedQ2 = 300;
        var iconPos1 = [[indXSeedQ1, 0], [indXSeedQ1, 40], [indXSeedQ1, 80], [indXSeedQ1, 120], [indXSeedQ1, 160],
            [indXSeedQ1, 200]];

        var iconPos2 = [[260, -90], [260, -10], [260, 70], [380, 150], [380, 230],
            [indXSeedQ1, 200]];

        const inconPos3Scale = d3.scaleLinear()
            .domain([1, 5])
            .range([-180, 320]);

        var iconPos3 = [[-60, inconPos3Scale(1)], [-60, inconPos3Scale(2)], [-60, inconPos3Scale(3)], [-60, inconPos3Scale(4)], [-60, inconPos3Scale(5)],];

        var legendPos = [[0, 0], [0, 200]];

        const txtMapInfo = [": wing width", ":   stem length", ":   seed head",
            ":   wing pattern", ":   head pattern"]

        const txtMapInfoXOffset = [138, 172, 176, 188, 156]

        //q1q2 icon+text
        {
            //添加图标和文字
            for (let i = 0; i < 6; i++) {
                const inGroup = groupIconsRight.append("g")
                    .attr("class", "groupIconsRight")
                    .attr("transform", `translate(${iconPos1[i][0]},${iconPos1[i][1]})`);

                if (i == 5)
                    inGroup
                        .attr("class", "txtAttr");


                // if(i == 6)
                //     inGroup.attr("opacity", ".5")

                if (i == 1) {
                    inGroup.append("image")
                        .attr("x", -2)
                        .attr("y", 0)
                        .attr("width", 28 * widScaleRatio)
                        .attr("xlink:href", `img/${svgArr[i]}.svg`);
                } else {
                    inGroup.append("image")
                        .attr("x", 0)
                        .attr("y", 0)
                        .attr("width", 24 * widScaleRatio)
                        .attr("xlink:href", `img/${svgArr[i]}.svg`);
                }

                inGroup.append("text")
                    .attr("id", `${svgArr[i]}TitTxt`)
                    .attr("x", 50) //第一天column坐标
                    .attr("y", 16)
                    .attr("class", "q1txt")
                    .style('font-weight', 300)
                    .style("font-size", ".7rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.7)')
                    .text(`${names[i]}`);


                inGroup.append("text")
                    .attr("id", `${svgArr[i]}Txt`)
                    .attr("opacity", 0)
                    .attr("x", txtMapInfoXOffset[i]) //第一天column坐标
                    .attr("y", 16)
                    .attr("class", "q1txt")
                    .style('font-weight', 300)
                    .style("font-size", ".7rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.7)')
                    .attr("id", `${svgArr[i]}Txt`)
                    .text(txtMapInfo[i]);

                if (i == 5) {
                    inGroup.append("image")
                        .attr("x", 100)
                        .attr("y", 0)
                        .attr("width", 10 * widScaleRatio)
                        .attr("xlink:href", `img/textIcon.svg`);
                }

                //添加星星
                const padding = 30;
                const rightmost = 250;
                const star = inGroup.append("g")
                    .attr("class", `starSeed`)
                    .attr("id", `star${svgArr2}`)
                    .attr("opacity", "0");

                if (imp[i] == 2.5) {
                    star.append("image")
                        .attr("x", rightmost)
                        .attr("y", 3)
                        .attr("width", 20 * widScaleRatio)
                        .attr("xlink:href", `img/star.svg`);
                    star.append("image")
                        .attr("x", rightmost - padding)
                        .attr("y", 3)
                        .attr("width", 20 * widScaleRatio)
                        .attr("xlink:href", `img/star.svg`);
                    star.append("image")
                        .attr("x", rightmost - 2 * padding + 10 * widScaleRatio)
                        .attr("y", 3)
                        .attr("width", 10 * widScaleRatio)
                        .attr("xlink:href", `img/half_star.svg`);
                } else if (imp[i] == 2) {
                    star.append("image")
                        .attr("x", rightmost)
                        .attr("y", 3)
                        .attr("width", 20 * widScaleRatio)
                        .attr("xlink:href", `img/star.svg`);
                    star.append("image")
                        .attr("x", rightmost - padding)
                        .attr("y", 3)
                        .attr("width", 20 * widScaleRatio)
                        .attr("xlink:href", `img/star.svg`);
                } else if (imp[i] == 1.5) {
                    star.append("image")
                        .attr("x", rightmost)
                        .attr("y", 3)
                        .attr("width", 20 * widScaleRatio)
                        .attr("xlink:href", `img/star.svg`);
                    star.append("image")
                        .attr("x", rightmost - padding + 10 * widScaleRatio)
                        .attr("y", 3)
                        .attr("width", 10 * widScaleRatio)
                        .attr("xlink:href", `img/half_star.svg`);
                } else if (imp[i] == 0.5) {
                    star.append("image")
                        .attr("x", rightmost + 10 * widScaleRatio)
                        .attr("y", 3)
                        .attr("width", 10 * widScaleRatio)
                        .attr("xlink:href", `img/half_star.svg`);
                }

            }

            //Q2
            //添加图标和文字
            for (let i = 0; i < 4; i++) {
                const inGroup = groupIconsLeft.append("g")
                    .attr("transform", `translate(0,${40 * i})`);


                inGroup.append("image")
                    .attr("x", 0)
                    .attr("y", 0)
                    .attr("width", 24 * widScaleRatio)
                    .attr("xlink:href", `img/${svgArr2[i]}.svg`);

                inGroup.append("text")
                    .attr("x", 50) //第一天column坐标
                    .attr("y", 16)
                    .style('font-weight', 300)
                    .style("font-size", ".7rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.7)')
                    .text(names2[i]);

                if (i == 2) {
                    inGroup.append("image")
                        .attr("x", 114)
                        .attr("y", 0)
                        .attr("width", 10 * widScaleRatio)
                        .attr("xlink:href", `img/textIcon.svg`);
                }

                //添加星星
                const padding = 30;
                const rightmost = 250;
                const star = inGroup.append("g")
                    .attr("id", `star${svgArr2}`)
                    .attr("class", `starSeed`)
                    .attr("opacity", "0");

                if (imp2[i] == 3) {
                    star.append("image")
                        .attr("x", rightmost)
                        .attr("y", 3)
                        .attr("width", 20 * widScaleRatio)
                        .attr("xlink:href", `img/star.svg`);
                    star.append("image")
                        .attr("x", rightmost - padding)
                        .attr("y", 3)
                        .attr("width", 20 * widScaleRatio)
                        .attr("xlink:href", `img/star.svg`);
                    star.append("image")
                        .attr("x", rightmost - 2 * padding)
                        .attr("y", 3)
                        .attr("width", 20 * widScaleRatio)
                        .attr("xlink:href", `img/star.svg`);
                } else if (imp2[i] == 2) {
                    star.append("image")
                        .attr("x", rightmost)
                        .attr("y", 3)
                        .attr("width", 20 * widScaleRatio)
                        .attr("xlink:href", `img/star.svg`);
                    star.append("image")
                        .attr("x", rightmost - padding)
                        .attr("y", 3)
                        .attr("width", 20 * widScaleRatio)
                        .attr("xlink:href", `img/star.svg`);
                } else if (imp2[i] == 1.5) {
                    star.append("image")
                        .attr("x", rightmost)
                        .attr("y", 3)
                        .attr("width", 20 * widScaleRatio)
                        .attr("xlink:href", `img/star.svg`);
                    star.append("image")
                        .attr("x", rightmost - padding + 10 * widScaleRatio)
                        .attr("y", 3)
                        .attr("width", 10 * widScaleRatio)
                        .attr("xlink:href", `img/half_star.svg`);
                }


            }

        }

        //图注
        //添加图注
        {
            const legendGroup = seedAttrGroup.append("g")
                .attr("id", "postAttriLegend")
                .attr("transform", `translate(0,${100})`)
                .attr("opacity", "1");

            const legendGroup1 = legendGroup.append("g")
                .attr("transform", `translate(0,${40 * 8})`);

            legendGroup1.append("image")
                .attr("x", 0)
                .attr("y", 0)
                .attr("width", 15 * widScaleRatio)
                .attr("opacity", ".6")
                .attr("xlink:href", `img/star.svg`);

            legendGroup1.append("text")
                .attr("x", 25) //第一天column坐标
                .attr("y", 12)
                .style('font-weight', 300)
                .style("font-size", ".6rem")
                .style('font-family', 'noto-sans, sans-serif')
                .style('fill', 'rgba(255,255,255,0.4)')
                .text("attribute importance");

            const legendGroup2 = legendGroup.append("g")
                .attr("transform", `translate(0,${40 * 8 + 30})`);

            legendGroup2.append("image")
                .attr("x", 2)
                .attr("y", 0)
                .attr("width", 11 * widScaleRatio)
                .attr("opacity", ".6")
                .attr("xlink:href", `img/textIcon.svg`);

            legendGroup2.append("text")
                .attr("x", 25) //第一天column坐标
                .attr("y", 12)
                .style('font-weight', 300)
                .style("font-size", ".6rem")
                .style('font-family', 'noto-sans, sans-serif')
                .style('fill', 'rgba(255,255,255,0.4)')
                .text("text data, unsuitable for graphic representation");
        }

        const seedQuestion1 = svg2.append("g")
            .attr("id", "seedQuestion1")
            .attr("opacity", 0)
            .attr("transform", `translate(${0}, ${130})`);

        seedQuestion1
            .append('text')
            .attr("x", 120)
            .attr("y", 20)
            .style('font-weight', 300)
            .style("font-size", "1rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,192,0,0.9)')
            .text("What voices were made in different stages?")

        seedQuestion1.append("image")
            .attr("x", 0)
            .attr("y", 0)
            .attr("width", 100 * widScaleRatio)
            .attr("xlink:href", "img/arr4.png");


        const seedQuestion2 = svg2.append("g")
            .attr("id", "seedQuestion2")
            .attr("opacity", 0)
            .attr("transform", `translate(${0}, ${510})`);

        seedQuestion2
            .append('text')
            .attr("x", 0)
            .attr("y", 40)
            .style('font-weight', 300)
            .style("font-size", "1rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,192,0,0.9)')
            .text("Who were influencers?")

        seedQuestion2.append("image")
            .attr("x", 280)
            .attr("y", 0)
            .attr("width", 100 * widScaleRatio)
            .attr("xlink:href", "img/arr5.png");

        // //seed 信息重要度（第一个问题）
        // {
        //
        //
        //     //添加title
        //     seedAttrGroup.append("text")
        //         .attr("x", 0)
        //         .attr("y", 50)
        //         .style('font-weight', 300)
        //         .style("font-size", "1.2rem")
        //         .style('font-family', 'hand')
        //         .style('opacity', '0')
        //         .style('id', 'titleQ1')
        //         .style('fill', 'rgba(255,255,255,0.7)')
        //         .text("Who were influencers?");
        //
        //     //添加map信息
        //     const mapTxt = seedAttrGroup.append("g")
        //         .attr("id", "q1Txt")
        //         .attr("opacity", "0")
        //         .attr("transform", `translate(400, 220)`)
        //     mapTxt.append("text")
        //         .attr("x", 0)
        //         .attr("y", 0)
        //         .style('font-weight', 300)
        //         .style("font-size", ".7rem")
        //         .style('font-family', 'hand')
        //         .style('fill', 'rgba(255,255,255,0.6)')
        //         .text("encoded into");
        //     mapTxt.append("text")
        //         .attr("x", 0)
        //         .attr("y", 20)
        //         .style('font-weight', 300)
        //         .style("font-size", ".7rem")
        //         .style('font-family', 'hand')
        //         .style('fill', 'rgba(255,255,255,0.6)')
        //         .text("seed glyph");
        //
        //     //绘制框选矩形框
        //     // groupIcons.append("rect")
        //     //     .attr("id", "q1Rect")
        //     //     .attr("x", -10)
        //     //     .attr("y", -10)
        //     //     .attr("rx", 10)
        //     //     .attr("ry", 10)
        //     //     .attr("opacity", "0")
        //     //     .attr("width", 340)
        //     //     .attr("height", 245)
        //     //     .attr("stroke", "#ffc000")
        //     //     .attr("stroke-width", "2")
        //     //     .attr("stroke-dasharray", "8, 8")
        //
        //     //添加箭头图片
        //     // groupIcons.append("image")
        //     //     .attr("id", "q1Arr")
        //     //     .attr("x", 340)
        //     //     .attr("y", 0)
        //     //     .attr("opacity", "0")
        //     //     .attr("width", 90 * widScaleRatio)
        //     //     .attr("xlink:href", `img/arr1.png`);
        //
        //
        //
        //
        //
        // }
        //
        // //seed 信息重要度（第二个问题）
        // {
        //     const groupBigQ2 = svg2.append("g")
        //         .attr("id", "groupBigQ2")
        //         .attr("transform", `translate(${60}, ${140})`);
        //
        //     const group2 = groupBigQ2.append("g")
        //         .attr("transform", `translate(${0}, ${100})`);
        //
        //
        //     //添加title
        //     const TitleGroup = groupBigQ2.append("g")
        //         .attr("opacity", "0")
        //         .attr("id", "titleQ2");
        //
        //     TitleGroup.append("text")
        //         .attr("x", 0)
        //         .attr("y", 20)
        //         .style('font-weight', 300)
        //         .style("font-size", "1.2rem")
        //         .style('font-family', 'hand')
        //         .style('fill', 'rgba(255,255,255,0.7)')
        //         .text("What voices were made");
        //
        //     TitleGroup.append("text")
        //         .attr("x", 0)
        //         .attr("y", 60)
        //         .style('font-weight', 300)
        //         .style("font-size", "1.2rem")
        //         .style('font-family', 'hand')
        //         .style('fill', 'rgba(255,255,255,0.7)')
        //         .text("in different stages?");
        //
        //     //添加map信息
        //     const mapTxt = groupBigQ2.append("g")
        //         .attr("id", "q2Txt")
        //         .attr("opacity", "0")
        //         .attr("transform", `translate(400, 220)`)
        //     mapTxt.append("text")
        //         .attr("x", 0)
        //         .attr("y", 0)
        //         .style('font-weight', 300)
        //         .style("font-size", ".7rem")
        //         .style('font-family', 'hand')
        //         .style('fill', 'rgba(255,255,255,0.6)')
        //         .text("encoded into");
        //     mapTxt.append("text")
        //         .attr("x", 0)
        //         .attr("y", 20)
        //         .style('font-weight', 300)
        //         .style("font-size", ".7rem")
        //         .style('font-family', 'hand')
        //         .style('fill', 'rgba(255,255,255,0.6)')
        //         .text("seed glyph");
        //
        //     //绘制框选矩形框
        //     group2.append("rect")
        //         .attr("id", "q2Rect")
        //         .attr("x", -10)
        //         .attr("y", -10)
        //         .attr("rx", 10)
        //         .attr("ry", 10)
        //         .attr("opacity", "0")
        //         .attr("width", 340)
        //         .attr("height", 245)
        //         .attr("stroke", "#ffc000")
        //         .attr("stroke-width", "2")
        //         .attr("stroke-dasharray", "8, 8")
        //
        //     //添加箭头图片
        //     group2.append("image")
        //         .attr("id", "q2Arr")
        //         .attr("x", 340)
        //         .attr("y", 0)
        //         .attr("opacity", "0")
        //         .attr("width", 90 * widScaleRatio)
        //         .attr("xlink:href", `img/arr1.png`);
        //
        // }

    }

    //seed sketch部分
    {
        var seedQ1Sketch = svg2.append("g")
            .attr("id", "seedQ1Sketch")
            .attr("opacity", 0);

        seedQ1Sketch
            .append("image")
            .attr("id", "seedQ1SketchImg")
            .attr("x", 130)
            .attr("y", 170 * heiScaleRatio)
            .attr("width", 300 * widScaleRatio)
            .attr("xlink:href", "img/seedQ1Sketch.png");

        var seedQ1SketchTxt = seedQ1Sketch.append("g")
            .attr("transform", `translate(${0}, ${210})`)

        seedQ1SketchTxt.append('text')
            .attr("x", 0)
            .attr("y", 0)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'noto-sans, sans-serif')
            .style('fill', 'rgba(255,255,255,0.8)')
            .text("width")

        seedQ1SketchTxt.append('text')
            .attr("x", 0)
            .attr("y", 80)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'noto-sans, sans-serif')
            .style('fill', 'rgba(255,255,255,0.8)')
            .text("length")

        seedQ1SketchTxt.append('text')
            .attr("x", 0)
            .attr("y", 160)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'noto-sans, sans-serif')
            .style('fill', 'rgba(255,255,255,0.8)')
            .text("head size")

        seedQ1SketchTxt.append('text')
            .attr("x", 0)
            .attr("y", 240)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'noto-sans, sans-serif')
            .style('fill', 'rgba(255,255,255,0.8)')
            .text("wing pattern")

        seedQ1SketchTxt.append('text')
            .attr("x", 0)
            .attr("y", 320)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'noto-sans, sans-serif')
            .style('fill', 'rgba(255,255,255,0.8)')
            .text("head pattern")
    }



    //seed Layout Sketch图片
    {
        const seedLayoutSketchGroup = svg2
            .append("g")
            .attr("id", "seedLayoutSketchGroup")
            .attr("opacity", 0);
        ;

        seedLayoutSketchGroup
            .append("image")
            .attr("x", 30)
            .attr("y", 180 * heiScaleRatio)
            .attr("width", 600 * widScaleRatio)
            .attr("opacity", "1")
            .attr("xlink:href", "img/seedLayoutSketch.png");

        seedLayoutSketchGroup
            .append('text')
            .attr("x", 120)
            .attr("y", 180)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,192,0,0.9)')
            .text("Outer X-axis: Hashtag Groups")

        seedLayoutSketchGroup
            .append('text')
            .attr("x", 300)
            .attr("y", 500)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,192,0,0.9)')
            .text("Inner X-axis: sentiment")

        seedLayoutSketchGroup
            .append('text')
            .attr("x", 90)
            .attr("y", 580)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,192,0,0.9)')
            .text("Color & rotate: sentiment")

        seedLayoutSketchGroup
            .append('text')
            .attr("x", 280)
            .attr("y", 400)
            .style('font-weight', 300)
            .style("font-size", ".6rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,192,0,0.7)')
            .text("negative_prob")

        seedLayoutSketchGroup
            .append('text')
            .attr("x", 280)
            .attr("y", 420)
            .style('font-weight', 300)
            .style("font-size", ".5rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,192,0,0.7)')
            .text("100%")

        seedLayoutSketchGroup
            .append('text')
            .attr("x", 560)
            .attr("y", 400)
            .style('font-weight', 300)
            .style("font-size", ".6rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,192,0,0.7)')
            .text("positive_prob")

        seedLayoutSketchGroup
            .append('text')
            .attr("x", 620)
            .attr("y", 420)
            .style('font-weight', 300)
            .style("font-size", ".5rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,192,0,0.7)')
            .text("100%")

        seedLayoutSketchGroup
            .append('text')
            .attr("x", 120)
            .attr("y", 150)
            .attr("transform", `translate(-100, 300), rotate(-90,100, 100)`)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,192,0,0.9)')
            .text("Y-axis: Timeline")
    }


    //seed overlay图片
    {
        const seedOverlayGroup = svg2
            .append("g")
            .attr("id", "seedOverlayGroup")
            .attr("opacity", 0);
        ;

        seedOverlayGroup
            .append("image")
            .attr("x", 30)
            .attr("y", 200 * heiScaleRatio)
            .attr("width", 500 * widScaleRatio)
            .attr("opacity", "1")
            .attr("xlink:href", "img/seedOverlap.png");

        seedOverlayGroup
            .append("image")
            .attr("x", 70)
            .attr("y", -240 * heiScaleRatio)
            .attr("width", 30 * widScaleRatio)
            .attr("transform", `scale(${1}, ${-1})`)
            .attr("opacity", "1")
            .attr("xlink:href", "img/arr2.png");


        seedOverlayGroup
            .append('text')
            .attr("x", 120)
            .attr("y", 150)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,192,0,0.9)')
            .text("posts cluster & overlap")
    }

    //seed forceLayout图片
    {
        const seedForceLayoutGroup = svg2
            .append("g")
            .attr("id", "seedForceLayoutGroup")
            .attr("opacity", 0);
        ;

        seedForceLayoutGroup
            .append("image")
            .attr("x", 30)
            .attr("y", 200 * heiScaleRatio)
            .attr("width", 500 * widScaleRatio)
            .attr("opacity", "1")
            .attr("xlink:href", "img/seedForceLayout.png");
    }


    //交互图表绘制部分
    {
        var seedTooltipGroup = svg2.append("g")
            .attr("transform", `translate(${20}, ${180})`)
            .attr("id", "seedTooltipGroup")
            .attr("opacity", 0);


        //likes
        {
            var likeGroup = seedTooltipGroup
                .append("g");

            var likeSvg = likeGroup
                .attr("transform", `translate(${0}, ${-40})`)
                .append("svg")
                .attr("width", `100%`)
                .attr("height", `${50}px`)

            var likeDefs = likeSvg.append("defs");

            geneSeed_Tp(likeSvg, likeDefs, 10, 42, 30, 1, 0.5, 1, false, "normal", 0.3, 1, 1, 1);
            geneSeed_Tp(likeSvg, likeDefs, 11, 190, 32, 1, 0.5, 1, false, "yellow", 0.3, 1, 1, 500);


            //likes legend
            {
                const likes = likeGroup.append("g")
                    .attr("transform", `translate(${45}, ${60})`);
                ;

                likes.append('text')
                    .attr("x", 0)
                    .attr("y", 0)
                    .style('font-weight', 300)
                    .style("font-size", ".6rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.6)')
                    .text("≤5000")

                likes.append('text')
                    .attr("x", 150)
                    .attr("y", 0)
                    .style('font-weight', 300)
                    .style("font-size", ".6rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.6)')
                    .text(">5000")

                //交互滑块
                {
                    // Simple
                    const data = [5000, 50000];
                    // const likeNumScale = d3.scaleLinear()
                    //     .domain([5000, 50000])
                    //     .range([0, 1]);

                    var sliderSimple = d3
                        .sliderBottom()
                        .min(d3.min(data))
                        .max(d3.max(data))
                        .width(150)
                        .ticks(0)
                        .default(0)
                        .on('onchange', val => {

                            //刷新seed
                            d3.select("#Tp_seed11")
                                .remove();
                            geneSeed_Tp(likeSvg, likeDefs, 11, 190, 32, 1, 0.5, 1, false, "yellow", 0.3, parseInt(val), 1, 1);

                            // d3.select('p#value-simple').text((val));
                        });

                    var gSimple = likes
                        .append('g')
                        .attr('transform', 'translate(250,-10)');

                    gSimple.call(sliderSimple);

                    // d3.select('p#value-simple').text(d3.format('.2%')(sliderSimple.value()));


                }
            }
        }

        //retweets
        {
            var retweetGroup = seedTooltipGroup
                .append("g")

            var retweetSvg = retweetGroup
                .attr("transform", `translate(${0}, ${80})`)
                .append("svg")
                .attr("width", `100%`)
                .attr("height", `${50}px`)

            var retweetDefs = retweetSvg.append("defs");

            geneSeed_Tp(retweetSvg, retweetDefs, 8, 42, 30, 1, 0.5, 1, false, "normal", 0.3, 1, 1, 1);
            geneSeed_Tp(retweetSvg, retweetDefs, 9, 190, 32, 1, 0.5, 1, false, "yellow", 0.3, 1, 1, 500);

            //retweet legend
            {
                const retweets = retweetGroup.append("g")
                    .attr("transform", `translate(${45}, ${60})`);
                ;

                retweets.append('text')
                    .attr("x", 0)
                    .attr("y", 0)
                    .style('font-weight', 300)
                    .style("font-size", ".6rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.6)')
                    .text("≤500")

                retweets.append('text')
                    .attr("x", 150)
                    .attr("y", 0)
                    .style('font-weight', 300)
                    .style("font-size", ".6rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.6)')
                    .text(">500")
                //交互滑块
                {
                    // Simple
                    const data = [500, 5000];
                    const retweetYScale = d3.scaleLinear()
                        .domain([500, 5000])
                        .range([30, 42]);

                    var sliderSimple = d3
                        .sliderBottom()
                        .min(d3.min(data))
                        .max(d3.max(data))
                        .width(150)
                        .ticks(0)
                        .default(0)
                        .on('onchange', val => {

                            //刷新seed
                            d3.select("#Tp_seed9")
                                .remove();

                            geneSeed_Tp(retweetSvg, retweetDefs, 9, 190, retweetYScale(val), 1, 0.5, 1, false, "yellow", 0.3, 1, 1, val);

                            // geneSeed_Tp(retweetSvg, retweetDefs, 9, 190, 32, 1, 0.5, 1, false, "yellow", 0.3, 1, 1, 500);

                            // d3.select('p#value-simple').text((val));
                        });

                    var gSimple = retweets
                        .append('g')
                        .attr('transform', 'translate(250,-10)');

                    gSimple.call(sliderSimple);

                    // d3.select('p#value-simple').text(d3.format('.2%')(sliderSimple.value()));


                }
            }



        }


        //followers
        {
            var followersGroup = seedTooltipGroup
                .append("g");

            var followerSvg = followersGroup
                .attr("transform", `translate(${0}, ${206})`)
                .append("svg")
                .attr("width", `100%`)
                .attr("height", `${2}rem`);

            var followerDefs = followerSvg.append("defs");

            geneSeed_Tp(followerSvg, followerDefs, 1, 42, 30, 1, 0.5, 1, false, "normal", 0.3, 1, 1, 1);
            geneSeed_Tp(followerSvg, followerDefs, 2, 190, 27.5, 2, 0.5, 1, false, "yellow", 0.3, 1, 1, 1);
            geneSeed_Tp(followerSvg, followerDefs, 3, 350, 25, 3, 0.5, 1, false, "yellow", 0.3, 1, 1, 1);

            //follower legend
            {
                const followers = followersGroup.append("g")
                    .attr("transform", `translate(${45}, ${70})`);
                ;

                followers.append('text')
                    .attr("x", 0)
                    .attr("y", 0)
                    .style('font-weight', 300)
                    .style("font-size", ".6rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.6)')
                    .text("≤10K")

                followers.append('text')
                    .attr("x", 130)
                    .attr("y", 0)
                    .style('font-weight', 300)
                    .style("font-size", ".6rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.6)')
                    .text("10K-1M")

                followers.append('text')
                    .attr("x", 300)
                    .attr("y", 0)
                    .style('font-weight', 300)
                    .style("font-size", ".6rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.6)')
                    .text(">1M")


            }
        }

        //comment
        {
            var commentGroup = seedTooltipGroup
                .append("g");

            var commentSvg = commentGroup
                .attr("transform", `translate(${0}, ${326})`)
                .append("svg")
                .attr("width", `100%`)
                .attr("height", `${50}px`)

            var commentDefs = commentSvg.append("defs");

            geneSeed_Tp(commentSvg, commentDefs, 12, 42, 30, 1, 0.5, 1, false, "normal", 0.3, 1, 1, 1);
            geneSeed_Tp(commentSvg, commentDefs, 13, 180, 30, 1, 0.5, 2, false, "yellow", 0.3, 1, 100, 1);
            geneSeed_Tp(commentSvg, commentDefs, 14, 340, 30, 1, 0.5, 3, false, "yellow", 0.3, 1, 200, 1);

            //comment legend
            {
                const comments = commentGroup.append("g")
                    .attr("transform", `translate(${45}, ${70})`);
                ;

                comments.append('text')
                    .attr("x", 0)
                    .attr("y", 0)
                    .style('font-weight', 300)
                    .style("font-size", ".6rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.6)')
                    .text("≤10")

                comments.append('text')
                    .attr("x", 130)
                    .attr("y", 0)
                    .style('font-weight', 300)
                    .style("font-size", ".6rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.6)')
                    .text("10-100")

                comments.append('text')
                    .attr("x", 300)
                    .attr("y", 0)
                    .style('font-weight', 300)
                    .style("font-size", ".6rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.6)')
                    .text(">100")


            }
        }

        //vlevel
        {
            var vlevelGroup = seedTooltipGroup
                .append("g");

            var vlevelSvg = vlevelGroup
                .attr("transform", `translate(${0}, ${460})`)
                .append("svg")
                .attr("width", `100%`)
                .attr("height", `${50}px`)

            var vlevelDefs = vlevelSvg.append("defs");

            geneSeed_Tp(vlevelSvg, vlevelDefs, 4, 42, 30, 1, 0.5, 1, true, "normal", 0.3, 1, 1, 1);
            geneSeed_Tp(vlevelSvg, vlevelDefs, 5, 180, 30, 1, 0.5, 1, true, "yellow", 0.3, 1, 1, 1);
            geneSeed_Tp(vlevelSvg, vlevelDefs, 6, 340, 30, 1, 0.5, 1, true, "gold", 0.3, 1, 1, 1);
            geneSeed_Tp(vlevelSvg, vlevelDefs, 7, 500, 30, 1, 0.5, 1, true, "blue", 0.3, 1, 1, 1);

            //vlevel legend
            {
                const vlevel = vlevelGroup.append("g")
                    .attr("transform", `translate(${20}, ${70})`);
                ;

                vlevel.append('text')
                    .attr("x", 0)
                    .attr("y", 0)
                    .style('font-weight', 300)
                    .style("font-size", ".6rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.6)')
                    .text("Individual Lv.1")

                vlevel.append('text')
                    .attr("x", 150)
                    .attr("y", 0)
                    .style('font-weight', 300)
                    .style("font-size", ".6rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.6)')
                    .text("Individual Lv.2")

                vlevel.append('text')
                    .attr("x", 300)
                    .attr("y", 0)
                    .style('font-weight', 300)
                    .style("font-size", ".6rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.6)')
                    .text("Individual Lv.3")

                vlevel.append('text')
                    .attr("x", 450)
                    .attr("y", 0)
                    .style('font-weight', 300)
                    .style("font-size", ".6rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.6)')
                    .text("Enterprise Account")


            }
        }


    }

</script>

<!--scroll magic svg2-->
<script>
    var divStayedScene7 = new ScrollMagic.Scene({
        triggerElement: "#encodePostEnter",
        duration: document.getElementById('seedForceLayoutExit').getBoundingClientRect().top - document.getElementById('encodePostEnter').getBoundingClientRect().top + 700 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: -11 * 24 * heiScaleRatio
    })
        .setPin("#divFixed2")

        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    //encode post data字不动
    var divStayedScene7 = new ScrollMagic.Scene({
        triggerElement: "#encodePostEnter",
        duration: 20 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: 3 * 24 * heiScaleRatio
    })

        .setPin("#seedEncodeFixed")

        // .addIndicators({name: "x 31)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene7 = new ScrollMagic.Scene({
        triggerElement: "#encodePostEnter",
        duration: 4 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: 3 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.selectAll(".starSeed")
                .attr("opacity", event.progress);
        })

        // .addIndicators({name: "x 11)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene7 = new ScrollMagic.Scene({
        triggerElement: "#encodePostEnter",
        duration: 4 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: 7 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            const scale = d3.scaleLinear()
                .domain([0, 1])
                .range([1, 0.1]);
            d3.select("#seedQRight")
                .attr("opacity", scale(event.progress));


            d3.select("#seedQuestion1")
                .attr("opacity", `${event.progress}`);

        })

        // .addIndicators({name: "x 22)"}) // add indicators (requires plugin)
        .addTo(controller);
    //
    // var divStayedScene7 = new ScrollMagic.Scene({
    //     triggerElement: "#encodePostEnter",
    //     duration: 4*24*heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
    //     offset: 11*24*heiScaleRatio
    // })
    //     .on("progress", function (event){
    //         d3.select("#seedQuestion1")
    //             .attr("opacity", `${1 - event.progress}`);
    //     })
    //
    //     .addIndicators({name: "x 33)"}) // add indicators (requires plugin)
    //     .addTo(controller);

    var divStayedScene7 = new ScrollMagic.Scene({
        triggerElement: "#encodePostEnter",
        duration: 4 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: 15 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {

            const scale = d3.scaleLinear()
                .domain([0, 1])
                .range([1, 0.1]);
            d3.select("#seedQLeft")
                .attr("opacity", scale(event.progress));

            const scale2 = d3.scaleLinear()
                .domain([0, 1])
                .range([0.1, 1]);
            d3.select("#seedQRight")
                .attr("opacity", scale2(event.progress));

            const scale3 = d3.scaleLinear()
                .domain([0, 0.4])
                .range([1, 0]);
            //titile退场
            d3.select("#seedQuestion1")
                .attr("opacity", `${scale3(event.progress)}`);

            d3.select("#seedQuestion2")
                .attr("opacity", `${event.progress}`);
        })

        .addIndicators({name: "x 33)"}) // add indicators (requires plugin)
        .addTo(controller);


    var divStayedScene7 = new ScrollMagic.Scene({
        triggerElement: "#encodePostEnter",
        duration: 4 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: -6 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            const seedAttrGroupYscale = d3.scaleLinear()
                .domain([0, 1])
                .range([seedAttrGroupIndY1, seedAttrGroupIndY2]);

            d3.select("#seedAttrGroup")
                .attr("transform", `translate(0,${seedAttrGroupYscale(event.progress)})`);


            // d3.selectAll(".q1txt")
            //     .attr("opacity", 1 - event.progress);

        })

        // .addIndicators({name: "xx"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene7 = new ScrollMagic.Scene({
        triggerElement: "#encodePostExit",
        duration: 4 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: 4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {

            d3.select("#postAttriLegend")
                .attr("opacity", `${1 - event.progress}`);
            d3.select("#seedQuestion2")
                .attr("opacity", `${1 - event.progress}`);
            // d3.selectAll(".q1txt")
            //     .attr("opacity", `${1 - event.progress}`);
            d3.selectAll(".starSeed")
                .attr("opacity", `${1 - event.progress}`);
            d3.select("#seedQLeft")
                .attr("opacity", 0.1 - 0.1 * event.progress);
            d3.selectAll(".txtAttr")
                .attr("opacity", `${1 - event.progress}`);

        })

        .addIndicators({name: "xx"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene7 = new ScrollMagic.Scene({
        triggerElement: "#encodePostExit",
        duration: 4 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: 8 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {


            d3.select("#seedQ1Sketch")
                .attr("opacity", event.progress);

            d3.selectAll(".groupIconsRight")
                .attr("transform", function (d, i) {
                    const scaleX = d3.scaleLinear()
                        .domain([0, 1])
                        .range([iconPos1[i][0], iconPos2[i][0]]);

                    const scaleY = d3.scaleLinear()
                        .domain([0, 1])
                        .range([iconPos1[i][1], iconPos2[i][1]]);
                    return `translate(${scaleX(event.progress)},${scaleY(event.progress)})`
                });


        })

        // .addIndicators({name: "xx"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene7 = new ScrollMagic.Scene({
        triggerElement: "#seedDataApplyEnter",
        duration: 4 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: -12 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {

            d3.select("#seedQ1Sketch").attr("opacity", 1 - event.progress);
            // d3.select("#seedAttrGroup").attr("opacity", 1 - event.progress);

            d3.selectAll(".groupIconsRight")
                .attr("transform", function (d, i) {
                    const scaleX = d3.scaleLinear()
                        .domain([0, 1])
                        .range([iconPos2[i][0], iconPos3[i][0]]);

                    const scaleY = d3.scaleLinear()
                        .domain([0, 1])
                        .range([iconPos2[i][1], iconPos3[i][1]]);
                    return `translate(${scaleX(event.progress)},${scaleY(event.progress)})`
                });

            d3.select("#likeTxt")
                .attr("opacity", event.progress);

            d3.select("#retweetTxt")
                .attr("opacity", event.progress);

            d3.select("#followersTxt")
                .attr("opacity", event.progress);

            d3.select("#commentsTxt")
                .attr("opacity", event.progress);

            d3.select("#accountLvTxt")
                .attr("opacity", event.progress);

            d3.select("#likeTitTxt")
                .style("font-weight", 300 + 200 * event.progress);

            d3.select("#retweetTitTxt")
                .style("font-weight", 300 + 200 * event.progress);

            d3.select("#followersTitTxt")
                .style("font-weight", 300 + 200 * event.progress);

            d3.select("#commentsTitTxt")
                .style("font-weight", 300 + 200 * event.progress);

            d3.select("#accountLvTitTxt")
                .style("font-weight", 300 + 200 * event.progress);


        })


        // .addIndicators({name: "xx"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene7 = new ScrollMagic.Scene({
        triggerElement: "#seedDataApplyEnter",
        duration: 4 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: -8 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#seedTooltipGroup")
                .attr("opacity", event.progress);
        })


        // .addIndicators({name: "xx"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene7 = new ScrollMagic.Scene({
        triggerElement: "#seedQ2Enter",
        duration: 4 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: -12 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {


            d3.select("#seedQRight")
                .attr("opacity", 1 - event.progress);

            d3.select("#seedTooltipGroup")
                .attr("opacity", 1 - event.progress);


        })

        // .addIndicators({name: "xx"}) // add indicators (requires plugin)
        .addTo(controller);


    var divStayedScene7 = new ScrollMagic.Scene({
        triggerElement: "#seedClusterEnter",
        duration: 4 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: -8 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {


            d3.select("#seedOverlayGroup")
                .attr("opacity", event.progress);

        })

        // .addIndicators({name: "xx"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene7 = new ScrollMagic.Scene({
        triggerElement: "#seedClusterExit",
        duration: 4 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: 4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {


            d3.select("#seedOverlayGroup")
                .attr("opacity", 1 - event.progress);

        })

        // .addIndicators({name: "xx"}) // add indicators (requires plugin)
        .addTo(controller);


    var divStayedScene7 = new ScrollMagic.Scene({
        triggerElement: "#seedForceLayoutEnter",
        duration: 4 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: -4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {


            d3.select("#seedForceLayoutGroup")
                .attr("opacity", event.progress);

        })

        // .addIndicators({name: "xx"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene7 = new ScrollMagic.Scene({
        triggerElement: "#seedQ2Enter",
        duration: 4 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: -6 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {


            d3.select("#seedLayoutSketchGroup")
                .attr("opacity", event.progress);

        })

        // .addIndicators({name: "xx"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene7 = new ScrollMagic.Scene({
        triggerElement: "#seedQ2Exit",
        duration: 4 * 24 * heiScaleRatio, //设置的比videoEnter更下面，保证视频出现的时候种子相对屏幕还是固定的，让种子的位置是唯一确定的，不会乱动
        offset: 4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {


            d3.select("#seedLayoutSketchGroup")
                .attr("opacity", 1 - event.progress);

        })

        // .addIndicators({name: "xx"}) // add indicators (requires plugin)
        .addTo(controller);


</script>

<!--d3资源加载svg3-->
<script>
    var svg3 = d3.select("#svg3")
        .attr("width", "120%")
        .attr("height", 0.9 * window.innerHeight);

    d3.select("#svg3")
        .append("image")
        .attr("id", "fisheyeSeed1")
        .attr("x", 30)
        .attr("y", 180 * heiScaleRatio)
        .attr("width", 600 * widScaleRatio)
        .attr("xlink:href", "img/fisheyeSeed1.png");

    d3.select("#svg3")
        .append("image")
        .attr("id", "fisheyeSeed2")
        .attr("opacity", 0)
        .attr("x", 60)
        .attr("y", 150 * heiScaleRatio)
        .attr("width", 500 * widScaleRatio)
        .attr("xlink:href", "img/fisheyeSeed2.png");

    const fisheyeSketch = d3.select("#svg3")
        .append("g")
        .attr("id", "fisheyeSketch")
        .attr("opacity", 0);

    fisheyeSketch
        .append("image")
        .attr("x", 30)
        .attr("y", 180 * heiScaleRatio)
        .attr("width", 400 * widScaleRatio)
        .attr("opacity", ".9")
        .attr("xlink:href", "img/fisheyeSketch.png");

    const fisheyeSketchTxt = fisheyeSketch.append("g")
        .attr("transform", `translate(350, 320)`);

    fisheyeSketchTxt
        .append('text')
        .attr("x", 30)
        .attr("y", 180 * heiScaleRatio)
        .style('font-weight', 300)
        .style("font-size", "1rem")
        .style('font-family', 'hand')
        .style('fill', 'rgba(255,255,255,0.7)')
        .text("Seeds near cursor")

    fisheyeSketchTxt
        .append('text')
        .attr("x", 30)
        .attr("y", 220 * heiScaleRatio)
        .style('font-weight', 300)
        .style("font-size", "1rem")
        .style('font-family', 'hand')
        .style('fill', 'rgba(255,255,255,0.7)')
        .text("turn larger")

</script>

<!--scroll magic svg3-->
<script>
    //svg固定
    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#otherChallenge1Enter",
        duration: document.getElementById('fisheyeSketch2Exit').getBoundingClientRect().top - document.getElementById('otherChallenge1Enter').getBoundingClientRect().top - 100 * heiScaleRatio,
        offset: 3 * 24 * heiScaleRatio
    })
        .setPin("#divFixed3")
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#otherChallenge1Exit",
        duration: 4 * 24 * heiScaleRatio,
        offset: 4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#fisheyeSeed1")
                .attr("opacity", 1 - event.progress)
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#fisheyeSketchEnter",
        duration: 4 * 24 * heiScaleRatio,
        offset: -4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#fisheyeSketch")
                .attr("opacity", event.progress)
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#fisheyeSketchExit",
        duration: 4 * 24 * heiScaleRatio,
        offset: 4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#fisheyeSketch")
                .attr("opacity", 1 - event.progress)
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#fisheyeSketch2Enter",
        duration: 4 * 24 * heiScaleRatio,
        offset: -4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#fisheyeSeed2")
                .attr("opacity", event.progress * 0.8)
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#fisheyeSketch2Exit",
        duration: 4 * 24 * heiScaleRatio,
        offset: 4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#fisheyeSeed2")
                .attr("opacity", 0.8 - 0.8 * event.progress)
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);
</script>


<!--d3资源加载svg4-->
<script>
    var svg4 = d3.select("#svg4")
        .attr("width", "120%")
        .attr("height", 0.9 * window.innerHeight);

    //第一切图
    {
        var windAnimscreen = d3.select("#svg4")
            .append("g")
            .attr("id", "windAnimscreen")
            .attr("transform", "translate(70, 0)")
            .attr("id", "windAnimscreen");

        windAnimscreen
            .append("image")
            .attr("x", 70)
            .attr("y", 0 * heiScaleRatio)
            .attr("id", "windAnimscreenBg")
            .attr("opacity", .8)
            .attr("width", 300 * widScaleRatio)
            .attr("xlink:href", "img/windAnimscreen.png");


        windAnimscreen
            .append("g")
            .attr("id", "windAnimscreenWindRot")
            .attr("transform", "translate(70, 200), scale(0.5)") //rotate(90,150,100)
            .append("image")
            .attr("x", 350)
            .attr("y", -290 * heiScaleRatio)
            .attr("opacity", .8)
            .attr("width", 220 * widScaleRatio)
            .attr("xlink:href", "img/screenWind.svg");

        windAnimscreen
            .append("g")
            .attr("id", "screenTimelineRot")
            .attr("transform", "translate(70, 200), scale(0.5)") //rotate(90,150,100)
            .append("image")
            .attr("x", 100)
            .attr("y", -20 * heiScaleRatio)
            .attr("opacity", .8)
            .attr("width", 400 * widScaleRatio)
            .attr("xlink:href", "img/screenTimeline.png");

        var xAxisTimeline = windAnimscreen
            .append("g")
            .attr("id", "xAxisTimeline")
            .attr('class', "challenge2Hidden");

        xAxisTimeline
            .append("text")
            .attr("x", 380 * widScaleRatio)
            .attr("y", 90 * heiScaleRatio)
            .style('font-weight', 300)
            .style("font-size", "1rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,192,0,0.9)')
            .text("X-axis: Timeline");

        xAxisTimeline
            .append("image")
            .attr("x", 240)
            .attr("y", 100 * heiScaleRatio)
            .attr("opacity", .8)
            .attr("width", 300 * widScaleRatio)
            .attr("xlink:href", "img/arr3.png");


        var yAxisTimeline = windAnimscreen
            .append("g")
            .attr("id", "yAxisTimeline")
            .attr('class', "challenge2Hidden");

        yAxisTimeline
            .append("text")
            .attr("transform", `rotate(-90)`)
            .attr("x", -400 * widScaleRatio)
            .attr("y", 430 * heiScaleRatio)
            .style('font-weight', 300)
            .style("font-size", "1rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,192,0,0.9)')
            .text("Y-axis: Timeline");


        yAxisTimeline
            .append("image")
            .attr("transform", `rotate(90)`)
            .attr("x", 200)
            .attr("y", -400 * heiScaleRatio)
            .attr("opacity", .8)
            .attr("width", 300 * widScaleRatio)
            .attr("xlink:href", "img/arr3.png");
    }

    svg4
        .append("image")
        .attr("id", "computer")
        .attr("x", 10)
        .attr("y", 150 * heiScaleRatio)
        .attr("opacity", 0)
        .attr("width", 700 * widScaleRatio)
        .attr("xlink:href", "img/computer.png");

    svg4
        .append("image")
        .attr("id", "seedPos")
        .attr("x", 120)
        .attr("y", 250 * heiScaleRatio)
        .attr("opacity", 0)
        .attr("width", 500 * widScaleRatio)
        .attr("xlink:href", "img/seedPos.png");


</script>

<!--scroll magic svg4-->
<script>
    //视频播放进度
    var windAnimVideo = document.getElementById("windAnimVideo");
    const windAnimXaxisScaleExit = d3.scaleLinear()
        .domain([0, 0.3])
        .range([0.7, 0]);

    const windAnimYaxisScale = d3.scaleLinear()
        .domain([0.7, 1])
        .range([0, 0.7]);
    const windAnimVideoTimeScale = d3.scaleLinear()
        .domain([0, 1])
        .range([0, 2.3]);
    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#optionBExit",
        duration: 6 * 24 * heiScaleRatio,
        offset: 16 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            windAnimVideo.currentTime = windAnimVideoTimeScale(event.progress);
            d3.select("#windAnimXaxis").style("opacity", windAnimXaxisScaleExit(event.progress));
            d3.select("#windAnimYaxis").style("opacity", windAnimYaxisScale(event.progress));

        })
        // .addIndicators({name: "2 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    //视频固定
    const windAnimXaxisScale = d3.scaleLinear()
        .domain([0.5, 1])
        .range([0, 0.7]);
    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#optionBExit",
        duration: 3 * 24 * heiScaleRatio,
        offset: 10 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#windAnimVideo").style("opacity", event.progress);
            d3.select("#windAnimXaxis").style("opacity", windAnimXaxisScale(event.progress));
        })
        // .addIndicators({name: "x (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    //视频固定
    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#optionBExit",
        duration: 10 * 24 * heiScaleRatio,
        offset: 18 * 24 * heiScaleRatio
    })
        .setPin("#optionCFixed")
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    //svg固定
    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#otherChallenge2Enter",
        duration: document.getElementById('optionCExit').getBoundingClientRect().top - document.getElementById('otherChallenge2Enter').getBoundingClientRect().top - 0 * heiScaleRatio,
        offset: 8.5 * 24 * heiScaleRatio
    })
        .setPin("#divFixed4")
        // .addIndicators({name: "x (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);


    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#otherChallenge2Exit",
        duration: 22 * 24 * heiScaleRatio,
        offset: 4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            const scaleMax = 3;
            const xOffsetMax = -650;
            const scaleId = d3.scaleLinear()
                .domain([0, 0.3])
                .range([1, scaleMax]);
            const xOffsetId = d3.scaleLinear()
                .domain([0, 0.3])
                .range([0, xOffsetMax]);
            const opacityId = d3.scaleLinear()
                .domain([0, 0.3])
                .range([1, 0]);

            if (event.progress <= 0.3) {
                windAnimscreen.attr("transform", `translate(${70 + xOffsetId(event.progress)}, 0), scale(${scaleId(event.progress)})`)
                d3.selectAll(".challenge2Hidden")
                    .attr("opacity", opacityId(event.progress))

                d3.select("#windAnimscreenWindRot")
                    .attr("transform", `translate(70, 200), scale(0.5), rotate(${0},470,-200)`) //改变旋转中心

            } else {
                windAnimscreen.attr("transform", `translate(${70 + xOffsetMax}, 0), scale(${scaleMax})`)
                d3.selectAll(".challenge2Hidden")
                    .attr("opacity", 0)
            }

            const windRotId = d3.scaleLinear()
                .domain([0.3, 0.6])
                .range([0, 90]);
            if (event.progress > 0.3 && event.progress <= 0.6) {
                d3.select("#windAnimscreenWindRot")
                    .attr("transform", `translate(70, 200), scale(0.5), rotate(${windRotId(event.progress)},470,-200)`) //改变旋转中心
            } else if (event.progress > 0.6) {
                d3.select("#windAnimscreenWindRot")
                    .attr("transform", `translate(70, 200), scale(0.5), rotate(${90},470,-200)`) //改变旋转中心
            }

            const xtrans = d3.scaleLinear()
                .domain([0.6, 0.75])
                .range([0, 250]);

            const ytrans = d3.scaleLinear()
                .domain([0.6, 0.75])
                .range([0, -20]);

            const scale = d3.scaleLinear()
                .domain([0.6, 0.75])
                .range([3, 0.33]);

            // if(event.progress < 0.6)
            // {
            //     d3.select("#yAxisTimeline")
            //         .attr("opacity", 1)
            //         .attr("transform", `translate(${0}, ${0}), scale(${3})`);
            // }
            if (event.progress >= 0.6 && event.progress <= 0.75) {
                d3.select("#yAxisTimeline")
                    .attr("opacity", 1)
                    .attr("transform", `translate(${xtrans(event.progress)}, ${ytrans(event.progress)}), scale(${scale(event.progress)})`);
            }

            if (event.progress > 0.75) {
                d3.select("#yAxisTimeline")
                    .attr("opacity", 1)
                    .attr("transform", `translate(250, -20), scale(0.33)`);
            }

        })
        // .addIndicators({name: "x (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#optionBEnter",
        duration: 30 * 24 * heiScaleRatio,
        offset: -14 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            const scaleMax = 3;
            const scaleMin = 2.2;
            const xOffsetMax = -650;
            const xOffsetMin = -200;
            const yOffsetMax = -300;

            const scaleId = d3.scaleLinear()
                .domain([0, 0.3])
                .range([scaleMax, scaleMin]);
            const xOffsetId = d3.scaleLinear()
                .domain([0, 0.3])
                .range([xOffsetMax, xOffsetMin]);
            const rotId = d3.scaleLinear()
                .domain([0, 0.3])
                .range([90, 0]);
            const timelineRotId = d3.scaleLinear()
                .domain([0.35, 0.6])
                .range([0, -90]);
            const yOffsetId = d3.scaleLinear()
                .domain([0, 0.3])
                .range([0, yOffsetMax]);


            if (event.progress <= 0.3) {
                windAnimscreen.attr("transform", `translate(${70 + xOffsetId(event.progress)}, ${yOffsetId(event.progress)}), scale(${scaleId(event.progress)})`)

                d3.select("#windAnimscreenWindRot")
                    .attr("transform", `translate(70, 200), scale(0.5), rotate(${rotId(event.progress)},470,-200)`) //改变旋转中心

            } else {
                windAnimscreen.attr("transform", `translate(${70 + xOffsetMin}, ${yOffsetMax}), scale(${scaleMin})`)
                d3.select("#windAnimscreenWindRot")
                    .attr("transform", `translate(70, 200), scale(0.5), rotate(${0})`) //改变旋转中心

            }

            if (event.progress <= 0.35) {
                d3.select("#screenTimelineRot")
                    .attr("transform", `translate(70, 200), scale(0.5), rotate(${0})`) //改变旋转中心
                d3.select("#computer")
                    .attr("opacity", 0);

                d3.select("#computer")
                    .attr("opacity", 0);

                d3.select("#seedPos")
                    .attr("opacity", 0);

            }

            const rotScaleId = d3.scaleLinear()
                .domain([0.35, 0.6])
                .range([scaleMin, 1.5]);
            const yyOffsetId = d3.scaleLinear()
                .domain([0.35, 0.6])
                .range([0, 180]);
            const computerOpacityId = d3.scaleLinear()
                .domain([0.35, 0.5])
                .range([0, 1]);

            const seedOpacityId = d3.scaleLinear()
                .domain([0.45, 0.6])
                .range([0, 1]);

            const bgOpacityId = d3.scaleLinear()
                .domain([0.35, 0.6])
                .range([1, 0]);

            if (event.progress > 0.35 && event.progress <= 0.6) {
                d3.select("#windAnimscreen")
                    .attr("transform", `translate(${-130}, ${-300 + yyOffsetId(event.progress)}), scale(${rotScaleId(event.progress)}), rotate(${timelineRotId(event.progress)},280,300)`) //改变旋转中心

                d3.select("#windAnimscreenBg")
                    .attr("opacity", bgOpacityId(event.progress)) //改变旋转中心

                d3.select("#computer")
                    .attr("opacity", computerOpacityId(event.progress));

                d3.select("#seedPos")
                    .attr("opacity", seedOpacityId(event.progress));

            }
            if (event.progress > 0.6) {
                d3.select("#windAnimscreenBg")
                    .attr("opacity", 0) //改变旋转中心

                d3.select("#windAnimscreen")
                    .attr("transform", `translate(-130, -120), scale(1.5), rotate(${-90},280,300)`) //改变旋转中心
                d3.select("#computer")
                    .attr("opacity", 1);

                d3.select("#computer")
                    .attr("opacity", 1);

                d3.select("#seedPos")
                    .attr("opacity", 1);
            }


        })
        // .addIndicators({name: "b (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#optionBExit",
        duration: 4 * 24 * heiScaleRatio,
        offset: 4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#svg4")
                .attr("opacity", 1 - event.progress)
        })
        // .addIndicators({name: "333333 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);


</script>

<!--d3资源加载svg5-->
<script>
    var svg5 = d3.select("#svg5")
        .attr("width", "120%")
        .attr("height", 0.9 * window.innerHeight)
        .attr("transform", `translate(0, 30)`);

    //map sketch 部分
    {
        var mapSketchGroup = svg5
            .append("g")
            .attr("id", "mapSketchGroup");

        mapSketchGroup
            .append("image")
            .attr("id", "mapSketch")
            .attr("x", 10)
            .attr("y", 150 * heiScaleRatio)
            .attr("opacity", 1)
            .attr("width", 700 * widScaleRatio)
            .attr("xlink:href", "img/mapSketch.png");

        mapSketchGroup
            .append("image")
            .attr("x", -120)
            .attr("y", 220 * heiScaleRatio)
            .attr("opacity", 1)
            .attr("width", 60 * widScaleRatio)
            .attr("transform", `scale(-1, 1)`)
            .attr("xlink:href", "img/arr1.png");

        mapSketchGroup
            .append("image")
            .attr("x", -450)
            .attr("y", -570 * heiScaleRatio)
            .attr("opacity", 1)
            .attr("width", 20 * widScaleRatio)
            .attr("transform", `scale(-1, -1)`)
            .attr("xlink:href", "img/arr2.png");

        mapSketchGroup
            .append('text')
            .attr("x", 25 * widScaleRatio)
            .attr("y", (500) * heiScaleRatio)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,192,0,0.8)')
            .text("select different options to see case distribution")

        mapSketchGroup
            .append('text')
            .attr("x", 25 * widScaleRatio)
            .attr("y", (300) * heiScaleRatio)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,192,0,0.8)')
            .text("glyph size: no. of cases")

        mapSketchGroup
            .append('text')
            .attr("x", 25 * widScaleRatio)
            .attr("y", (574) * heiScaleRatio)
            .style('font-weight', 300)
            .style("font-size", ".4rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,255,255,0.7)')
            .text("YEAR")

        mapSketchGroup
            .append('text')
            .attr("x", 100 * widScaleRatio)
            .attr("y", (573) * heiScaleRatio)
            .style('font-weight', 300)
            .style("font-size", ".4rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,255,255,0.7)')
            .text("GENDER")

        mapSketchGroup
            .append('text')
            .attr("x", 185 * widScaleRatio)
            .attr("y", (572) * heiScaleRatio)
            .style('font-weight', 300)
            .style("font-size", ".4rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,255,255,0.7)')
            .text("AGE")

        mapSketchGroup
            .append('text')
            .attr("x", 230 * widScaleRatio)
            .attr("y", (570) * heiScaleRatio)
            .style('font-weight', 300)
            .style("font-size", ".4rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,255,255,0.7)')
            .text("MEANS OF CONTROL")

        mapSketchGroup
            .append('text')
            .attr("x", 360 * widScaleRatio)
            .attr("y", (570) * heiScaleRatio)
            .style('font-weight', 300)
            .style("font-size", ".4rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,255,255,0.7)')
            .text("TYPE OF EXPLOIT")

        mapSketchGroup
            .append('text')
            .attr("x", 470 * widScaleRatio)
            .attr("y", (570) * heiScaleRatio)
            .style('font-weight', 300)
            .style("font-size", ".4rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,255,255,0.7)')
            .text("TYPE OF LABOUR")

        mapSketchGroup
            .append('text')
            .attr("x", 590 * widScaleRatio)
            .attr("y", (570) * heiScaleRatio)
            .style('font-weight', 300)
            .style("font-size", ".4rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,255,255,0.7)')
            .text("TYPE OF SEX")
    }

    //sc1
    svg5
        .append("image")
        .attr("id", "mapSC1")
        .attr("x", 0)
        .attr("y", 190 * heiScaleRatio)
        .attr("opacity", 0)
        .attr("width", 700 * widScaleRatio)
        .attr("xlink:href", "img/mapSC1.png");

    //sc5
    svg5
        .append("image")
        .attr("id", "mapSC5")
        .attr("x", 0)
        .attr("y", 190 * heiScaleRatio)
        .attr("opacity", 0)
        .attr("width", 700 * widScaleRatio)
        .attr("xlink:href", "img/mapSC1.png"); //等待更新

    //sc2&3
    {
        var mapSC2_3 = svg5.append("g")
            .attr("id", "mapSC2_3")
            .attr("opacity", 0);

        mapSC2_3
            .append("image")
            .attr("id", "mapSC2")
            .attr("x", 0)
            .attr("y", 190 * heiScaleRatio)
            .attr("opacity", 1)
            .attr("width", 700 * widScaleRatio)
            .attr("xlink:href", "img/mapSC2.png");

        mapSC2_3
            .append("image")
            .attr("id", "mapSC3")
            .attr("x", 0)
            .attr("y", 190 * heiScaleRatio)
            .attr("opacity", 0)
            .attr("width", 700 * widScaleRatio)
            .attr("xlink:href", "img/mapSC3.png");

        var mapSC2legend = mapSC2_3.append("g")
            .attr("id", "mapSC2legend")
            .attr("opacity", 1);

        mapSC2legend
            .append("image")
            .attr("x", 160)
            .attr("y", 420 * heiScaleRatio)
            .attr("opacity", 1)
            .attr("width", 25 * widScaleRatio)
            .attr("xlink:href", "img/arr2.png");

        var mapSC2legendTxt = mapSC2legend
            .append("g")
            .attr("transform", `translate(${200}, ${500})`);

        mapSC2legendTxt
            .append('text')
            .attr("x", 0)
            .attr("y", (0) * heiScaleRatio)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,192,0,0.9)')
            .text("e.g. this glyph represents cases from");

        mapSC2legendTxt
            .append('text')
            .attr("x", 0)
            .attr("y", (30) * heiScaleRatio)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,192,0,0.9)')
            .text("the US, Mexico, Haiti, etc.");

        var mapSC3legend = mapSC2_3.append("g")
            .attr("id", "mapSC3legend")
            .attr("opacity", 0);

        mapSC3legend
            .append("image")
            .attr("x", -240)
            .attr("y", 370 * heiScaleRatio)
            .attr("opacity", 1)
            .attr("transform", `scale(-1, 1)`)
            .attr("width", 20 * widScaleRatio)
            .attr("xlink:href", "img/arr2.png");

        var mapSC3legendTxt = mapSC3legend
            .append("g")
            .attr("transform", `translate(${150}, ${460})`);

        mapSC3legendTxt
            .append('text')
            .attr("x", 0)
            .attr("y", (0) * heiScaleRatio)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,192,0,0.9)')
            .text("the US has more cases")

        mapSC3legendTxt
            .append('text')
            .attr("x", 0)
            .attr("y", (30) * heiScaleRatio)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,192,0,0.9)')
            .text("=>wind glyph closer to the US")

    }

    //sc4
    var mapSC4 = svg5.append("g")
        .attr("id", "mapSC4")
        .attr("opacity", 0);

    mapSC4.append("image")
        .attr("id", "mapSC4")
        .attr("x", 0)
        .attr("y", 130 * heiScaleRatio)
        .attr("width", 700 * widScaleRatio)
        .attr("xlink:href", "img/mapProbs.png");

    var mapSC4Txt = mapSC4.append("g")
        .attr("transform", `translate(${420 * widScaleRatio}, ${240})`);

    mapSC4Txt
        .append('text')
        .attr("x", 0)
        .attr("y", 0)
        .style('font-weight', 300)
        .style("font-size", ".7rem")
        .style('font-family', 'hand')
        .style('fill', 'rgba(255,192,0,0.9)')
        .text("Some of these \"Asian winds\"")

    mapSC4Txt
        .append('text')
        .attr("x", 0)
        .attr("y", 30)
        .style('font-weight', 300)
        .style("font-size", ".7rem")
        .style('font-family', 'hand')
        .style('fill', 'rgba(255,192,0,0.9)')
        .text("should also be clustered")


    var mapSC4Txt2 = mapSC4.append("g")
        .attr("transform", `translate(${130 * widScaleRatio}, ${540})`);

    mapSC4Txt2
        .append('text')
        .attr("x", 0)
        .attr("y", 0)
        .style('font-weight', 300)
        .style("font-size", ".7rem")
        .style('font-family', 'hand')
        .style('fill', 'rgba(255,192,0,0.9)')
        .text("Wind over the Atlantic")


</script>

<!--scroll magic svg5-->
<script>
    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#mapSketchEnter",
        duration: document.getElementById('mapContinentExit').getBoundingClientRect().top - document.getElementById('mapSketchEnter').getBoundingClientRect().top - 100 * heiScaleRatio,
        offset: 3 * 24 * heiScaleRatio
    })
        .setPin("#divFixed5")
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#mapSketchExit",
        duration: 4 * 24 * heiScaleRatio,
        offset: 4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#mapSketchGroup").attr("opacity", 1 - event.progress);
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#oneGlyphEnter",
        duration: 4 * 24 * heiScaleRatio,
        offset: -4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#mapSC1").attr("opacity", event.progress);
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#oneGlyphExit",
        duration: 4 * 24 * heiScaleRatio,
        offset: 4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#mapSC1").attr("opacity", 1 - event.progress);
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#kMeansEnter",
        duration: 4 * 24 * heiScaleRatio,
        offset: -4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#mapSC2_3").attr("opacity", event.progress);
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#kMeansExit",
        duration: 4 * 24 * heiScaleRatio,
        offset: 4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#mapSC2_3").attr("opacity", 1 - event.progress);
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);


    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#mapProbEnter",
        duration: 4 * 24 * heiScaleRatio,
        offset: -4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#mapSC4").attr("opacity", event.progress);
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);


    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#mapProbExit",
        duration: 4 * 24 * heiScaleRatio,
        offset: 4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#mapSC4").attr("opacity", 1 - event.progress);
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);


    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#mapContinentEnter",
        duration: 4 * 24 * heiScaleRatio,
        offset: -4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#mapSC5").attr("opacity", event.progress);
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);


</script>


<!--d3资源加载svg6-->
<script>
    var svg6 = d3.select("#svg6")
        .attr("width", "120%")
        .attr("height", 0.9 * window.innerHeight)
        .attr("transform", `translate(0, 30)`);
    var defs6 = svg6.append("defs");

    //wind attribute动画显示
    {
        const windAttrGroup = svg6.append("g")
            .attr("id", "windAttrGroup")
            .attr("transform", `translate(${0}, ${0})`);
        var windAttrGroupIndY1 = 0;
        var windAttrGroupIndY2 = 120;

        const groupIconsLeft = windAttrGroup.append("g")
            .attr("id", "windQLeft")
            .attr("transform", `translate(${10}, ${100})`);

        const groupIconsRight = windAttrGroup.append("g")
            .attr("id", "windQRight")
            .attr("transform", `translate(${10}, ${100})`);

        const svgArr2 = ["hashtagGroups", "time"] //
        const names2 = ["hashtag group", "create time & active time duration"]
        const imp2 = [3, 3];

        const svgArr = ["view", "original", "comments", "senti", "hashtag"]
        const names = ["no. of views", "no. of originals", "no. of discussions", "sentiment", "included hashtags"]
        const imp = [2.5, 2.5, 2.5, 1.5, 1];

        // var indXSeedQ2 = 300;

        var legendPos = [[0, 0], [0, 200]];

        //q1q2 icon+text
        {
            //添加图标和文字
            for (let i = 0; i < 5; i++) {
                const inGroup = groupIconsRight.append("g")
                    .attr("transform", `translate(0,${40 * (i + 2)})`);

                if (i == 0) {
                    inGroup.append("image")
                        .attr("x", -2)
                        .attr("y", 0)
                        .attr("width", 28 * widScaleRatio)
                        .attr("xlink:href", `img/${svgArr[i]}.svg`);
                } else if (i == 4) {
                    inGroup.append("image")
                        .attr("x", 2)
                        .attr("y", 0)
                        .attr("width", 20 * widScaleRatio)
                        .attr("xlink:href", `img/${svgArr[i]}.svg`);
                } else {
                    inGroup.append("image")
                        .attr("x", 0)
                        .attr("y", 0)
                        .attr("width", 24 * widScaleRatio)
                        .attr("xlink:href", `img/${svgArr[i]}.svg`);
                }

                inGroup.append("text")
                    .attr("id", `${svgArr[i]}TitTxt`)
                    .attr("x", 50) //第一天column坐标
                    .attr("y", 16)
                    .style('font-weight', 300)
                    .style("font-size", ".7rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.7)')
                    .text(`${names[i]}`);


                if (i == 4) {
                    inGroup.append("image")
                        .attr("x", 200)
                        .attr("y", 0)
                        .attr("width", 10 * widScaleRatio)
                        .attr("xlink:href", `img/textIcon.svg`);
                }

                //添加星星
                const padding = 30;
                const rightmost = 400;
                const star = inGroup.append("g")
                    .attr("class", `starWind`)
                    .attr("opacity", "1");

                if (imp[i] == 2.5) {
                    star.append("image")
                        .attr("x", rightmost)
                        .attr("y", 3)
                        .attr("width", 20 * widScaleRatio)
                        .attr("xlink:href", `img/star.svg`);
                    star.append("image")
                        .attr("x", rightmost - padding)
                        .attr("y", 3)
                        .attr("width", 20 * widScaleRatio)
                        .attr("xlink:href", `img/star.svg`);
                    star.append("image")
                        .attr("x", rightmost - 2 * padding + 10 * widScaleRatio)
                        .attr("y", 3)
                        .attr("width", 10 * widScaleRatio)
                        .attr("xlink:href", `img/half_star.svg`);
                } else if (imp[i] == 1) {
                    star.append("image")
                        .attr("x", rightmost)
                        .attr("y", 3)
                        .attr("width", 20 * widScaleRatio)
                        .attr("xlink:href", `img/star.svg`);

                } else if (imp[i] == 1.5) {
                    star.append("image")
                        .attr("x", rightmost)
                        .attr("y", 3)
                        .attr("width", 20 * widScaleRatio)
                        .attr("xlink:href", `img/star.svg`);
                    star.append("image")
                        .attr("x", rightmost - padding + 10 * widScaleRatio)
                        .attr("y", 3)
                        .attr("width", 10 * widScaleRatio)
                        .attr("xlink:href", `img/half_star.svg`);
                }

            }

            //Q2
            //添加图标和文字
            for (let i = 0; i < 2; i++) {
                const inGroup = groupIconsLeft.append("g")
                    .attr("transform", `translate(0,${40 * i})`);


                inGroup.append("image")
                    .attr("x", 0)
                    .attr("y", 0)
                    .attr("width", 24 * widScaleRatio)
                    .attr("xlink:href", `img/${svgArr2[i]}.svg`);

                inGroup.append("text")
                    .attr("x", 50) //第一天column坐标
                    .attr("y", 16)
                    .style('font-weight', 300)
                    .style("font-size", ".7rem")
                    .style('font-family', 'noto-sans, sans-serif')
                    .style('fill', 'rgba(255,255,255,0.7)')
                    .text(names2[i]);


                //添加星星
                const padding = 30;
                const rightmost = 400;
                const star = inGroup.append("g")
                    .attr("class", `starWind`)
                    .attr("opacity", "1");

                if (imp2[i] == 3) {
                    star.append("image")
                        .attr("x", rightmost)
                        .attr("y", 3)
                        .attr("width", 20 * widScaleRatio)
                        .attr("xlink:href", `img/star.svg`);
                    star.append("image")
                        .attr("x", rightmost - padding)
                        .attr("y", 3)
                        .attr("width", 20 * widScaleRatio)
                        .attr("xlink:href", `img/star.svg`);
                    star.append("image")
                        .attr("x", rightmost - 2 * padding)
                        .attr("y", 3)
                        .attr("width", 20 * widScaleRatio)
                        .attr("xlink:href", `img/star.svg`);
                }


            }

        }

        //图注
        //添加图注
        {
            const legendGroup = windAttrGroup.append("g")
                .attr("id", "windAttriLegend")
                .attr("transform", `translate(0,${100})`)
                .attr("opacity", "1");

            const legendGroup1 = legendGroup.append("g")
                .attr("transform", `translate(0,${40 * 8})`);

            legendGroup1.append("image")
                .attr("x", 0)
                .attr("y", 0)
                .attr("width", 15 * widScaleRatio)
                .attr("opacity", ".6")
                .attr("xlink:href", `img/star.svg`);

            legendGroup1.append("text")
                .attr("x", 25) //第一天column坐标
                .attr("y", 12)
                .style('font-weight', 300)
                .style("font-size", ".6rem")
                .style('font-family', 'noto-sans, sans-serif')
                .style('fill', 'rgba(255,255,255,0.4)')
                .text("attribute importance");

            const legendGroup2 = legendGroup.append("g")
                .attr("transform", `translate(0,${40 * 8 + 30})`);

            legendGroup2.append("image")
                .attr("x", 2)
                .attr("y", 0)
                .attr("width", 11 * widScaleRatio)
                .attr("opacity", ".6")
                .attr("xlink:href", `img/textIcon.svg`);

            legendGroup2.append("text")
                .attr("x", 25) //第一天column坐标
                .attr("y", 12)
                .style('font-weight', 300)
                .style("font-size", ".6rem")
                .style('font-family', 'noto-sans, sans-serif')
                .style('fill', 'rgba(255,255,255,0.4)')
                .text("text data, unsuitable for graphic representation");
        }


    }

    //group sketch group
    {
        const group1 = svg6.append("g")
            .attr("id", "windGroupSketch1")
            .attr("opacity", "0");

        group1
            .append('text')
            .attr("x", 100)
            .attr("y", 160)
            .style('font-weight', 300)
            .style("font-size", ".8rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,192,0,0.9)')
            .text("encoded into wind layout")

        group1
            .append("image")
            .attr("id", "mapSketch")
            .attr("x", 10)
            .attr("y", 150 * heiScaleRatio)
            .attr("opacity", 1)
            .attr("transform", `translate(10, 220), rotate(-90), scale(0.1)`)
            .attr("width", 700 * widScaleRatio)
            .attr("xlink:href", "img/arr1.png");

        const group2 = svg6.append("g")
            .style("id", "windGroupSketch2")
            .attr("transform", `translate(300, 400)`)
            .attr("opacity", "0");

        group2
            .append('text')
            .attr("x", 100)
            .attr("y", 150)
            .style('font-weight', 300)
            .style("font-size", ".8rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,192,0,0.9)')
            .text("encoded into wind glyph")

        group2
            .append("image")
            .attr("id", "mapSketch")
            .attr("x", 10)
            .attr("y", 150 * heiScaleRatio)
            .attr("opacity", 1)
            .attr("transform", `translate(-40, 120), rotate(-60), scale(0.05)`)
            .attr("width", 700 * widScaleRatio)
            .attr("xlink:href", "img/arr2.png");
    }

    svg6
        .append("image")
        .attr("id", "windMap")
        .attr("x", 20)
        .attr("y", 250 * heiScaleRatio)
        .attr("opacity", 0)
        .attr("width", 600 * widScaleRatio)
        .attr("xlink:href", "img/windmap.png");

    //降维group
    // {
    //     var dimensionRedGroup = svg6.append("g")
    //         .attr("id", "dimensionRedGroup")
    //         .attr("transform", `translate(${0}, ${100})`)
    //         .attr("opacity", 1);
    //
    //     //views
    //     {
    //         const views = dimensionRedGroup.append("g");
    //
    //         views
    //             .append("image")
    //             .attr("x", 10)
    //             .attr("y", 150 * heiScaleRatio)
    //             .attr("opacity", 1)
    //             .attr("width", 50 * widScaleRatio)
    //             .attr("xlink:href", "img/view.svg");
    //
    //         views
    //             .append('text')
    //             .attr("x", 220)
    //             .attr("y", 150 * heiScaleRatio)
    //             .style('font-weight', 300)
    //             .style("font-size", ".7rem")
    //             .style('font-family', 'hand')
    //             .style('fill', 'rgba(255,192,0,0.6)')
    //             .text("<500M")
    //
    //         views
    //             .append('text')
    //             .attr("x", 400)
    //             .attr("y", 150 * heiScaleRatio)
    //             .style('font-weight', 300)
    //             .style("font-size", ".7rem")
    //             .style('font-family', 'hand')
    //             .style('fill', 'rgba(255,192,0,0.6)')
    //             .text("500M - 4B")
    //
    //         views
    //             .append('text')
    //             .attr("x", 570)
    //             .attr("y", 150 * heiScaleRatio)
    //             .style('font-weight', 300)
    //             .style("font-size", ".7rem")
    //             .style('font-family', 'hand')
    //             .style('fill', 'rgba(255,192,0,0.6)')
    //             .text(">4B")
    //     }
    //
    //     //discussion
    //     {
    //         const discussions = dimensionRedGroup.append("g")
    //             .attr("transform", `translate(0, 200)`);
    //
    //         discussions
    //             .append("image")
    //             .attr("x", 10)
    //             .attr("y", 150 * heiScaleRatio)
    //             .attr("opacity", 1)
    //             .attr("width", 40 * widScaleRatio)
    //             .attr("xlink:href", "img/comments.svg");
    //
    //         discussions
    //             .append('text')
    //             .attr("x", 220)
    //             .attr("y", 150 * heiScaleRatio)
    //             .style('font-weight', 300)
    //             .style("font-size", ".7rem")
    //             .style('font-family', 'hand')
    //             .style('fill', 'rgba(255,192,0,0.6)')
    //             .text("<200K")
    //
    //         discussions
    //             .append('text')
    //             .attr("x", 400)
    //             .attr("y", 150 * heiScaleRatio)
    //             .style('font-weight', 300)
    //             .style("font-size", ".7rem")
    //             .style('font-family', 'hand')
    //             .style('fill', 'rgba(255,192,0,0.6)')
    //             .text("200K - 2M")
    //
    //         discussions
    //             .append('text')
    //             .attr("x", 570)
    //             .attr("y", 150 * heiScaleRatio)
    //             .style('font-weight', 300)
    //             .style("font-size", ".7rem")
    //             .style('font-family', 'hand')
    //             .style('fill', 'rgba(255,192,0,0.6)')
    //             .text(">2M")
    //     }
    //
    //     //influence
    //     {
    //         const influence = dimensionRedGroup.append("g");
    //
    //         influence
    //             .append('text')
    //             .attr("x", 0)
    //             .attr("y", 500)
    //             .style('font-weight', 300)
    //             .style("font-size", ".8rem")
    //             .style('font-family', 'hand')
    //             .style('fill', 'rgba(255,192,0,0.9)')
    //             .text("Influence")
    //
    //         influence
    //             .append('text')
    //             .attr("x", 180)
    //             .attr("y", 500)
    //             .style('font-weight', 300)
    //             .style("font-size", ".7rem")
    //             .style('font-family', 'hand')
    //             .style('fill', 'rgba(255,192,0,0.6)')
    //             .text("+")
    //
    //         influence
    //             .append('text')
    //             .attr("x", 400)
    //             .attr("y", 500)
    //             .style('font-weight', 300)
    //             .style("font-size", ".7rem")
    //             .style('font-family', 'hand')
    //             .style('fill', 'rgba(255,192,0,0.6)')
    //             .text("+ +")
    //
    //         influence
    //             .append('text')
    //             .attr("x", 570)
    //             .attr("y", 500)
    //             .style('font-weight', 300)
    //             .style("font-size", ".7rem")
    //             .style('font-family', 'hand')
    //             .style('fill', 'rgba(255,192,0,0.6)')
    //             .text("+ + +")
    //     }
    //
    //     //included hashtag
    //     {
    //         const includedHashtags = dimensionRedGroup.append("g")
    //             .attr("transform", `translate(0, 100)`);
    //
    //
    //         includedHashtags
    //             .append('text')
    //             .attr("x", 0)
    //             .attr("y", 500)
    //             .style('font-weight', 300)
    //             .style("font-size", ".8rem")
    //             .style('font-family', 'hand')
    //             .style('fill', 'rgba(255,192,0,0.9)')
    //             .text("Included groups")
    //
    //         includedHashtags
    //             .append('text')
    //             .attr("x", 180)
    //             .attr("y", 500)
    //             .style('font-weight', 300)
    //             .style("font-size", ".7rem")
    //             .style('font-family', 'hand')
    //             .style('fill', 'rgba(255,192,0,0.6)')
    //             .text("report 2 & reflection")
    //
    //         includedHashtags
    //             .append('text')
    //             .attr("x", 180)
    //             .attr("y", 520)
    //             .style('font-weight', 300)
    //             .style("font-size", ".7rem")
    //             .style('font-family', 'hand')
    //             .style('fill', 'rgba(255,192,0,0.6)')
    //             .text("& other")
    //
    //         includedHashtags
    //             .append('text')
    //             .attr("x", 400)
    //             .attr("y", 500)
    //             .style('font-weight', 300)
    //             .style("font-size", ".7rem")
    //             .style('font-family', 'hand')
    //             .style('fill', 'rgba(255,192,0,0.6)')
    //             .text("report 3, 4, 6")
    //
    //         includedHashtags
    //             .append('text')
    //             .attr("x", 570)
    //             .attr("y", 500)
    //             .style('font-weight', 300)
    //             .style("font-size", ".7rem")
    //             .style('font-family', 'hand')
    //             .style('fill', 'rgba(255,192,0,0.6)')
    //             .text("report 1, 5")
    //     }
    // }

    d3.select("#dimensionRedDiv")
        .style("width", `${window.innerWidth - 10 * 24}px`)
        .style("height", `${window.innerHeight - 10 * 24}px`);

    d3.select("#Attr3MapDiv")
        .style("width", `${window.innerWidth - 10 * 24}px`)
        .style("height", `${window.innerHeight - 10 * 24}px`);

    //映射sketch group
    {
        const group = svg6.append("g")
            .attr("id", "windSketchAttrsMap")
            .attr("opacity", 0);

        group
            .append("image")
            .attr("id", "windMap")
            .attr("x", 190)
            .attr("y", 80 * heiScaleRatio)
            .attr("opacity", 1)
            .attr("width", 400 * widScaleRatio)
            .attr("xlink:href", "img/windAttrSketch.png");

        const txt = ["windline(s)", "curvedness_tail", "curvedness_head", "stroke width", "gradient proportion", "gradient color", "length"]
        for (let i = 0; i < 7; i++) {
            group
                .append('text')
                .attr("x", 20)
                .attr("y", 150 + i * 90)
                .style('font-weight', 300)
                .style("font-size", ".7rem")
                .style('font-family', 'noto-sans, sans-serif')
                .style('fill', 'rgba(255,255,255,0.8)')
                .text(txt[i])
        }

        //hashtag group
        {
            const hashtagGroup = group.append("g")
                .attr("transform", `translate(480, 130)`);

            hashtagGroup
                .append("image")
                .attr("x", 0)
                .attr("y", 0 * heiScaleRatio)
                .attr("width", 24 * widScaleRatio)
                .attr("xlink:href", "img/hashtagGroups.svg");

            hashtagGroup
                .append('text')
                .attr("x", 40)
                .attr("y", 17 * heiScaleRatio)
                .style('font-weight', 300)
                .style("font-size", ".7rem")
                .style('font-family', 'noto-sans, sans-serif')
                .style('fill', 'rgba(255,255,255,0.8)')
                .text("hashtag group")
        }

        //sentiment
        {
            const sentiGroup = group.append("g")
                .attr("transform", `translate(480, 580)`);

            sentiGroup
                .append("image")
                .attr("x", 0)
                .attr("y", 0 * heiScaleRatio)
                .attr("width", 24 * widScaleRatio)
                .attr("xlink:href", "img/senti.svg");

            sentiGroup
                .append('text')
                .attr("x", 40)
                .attr("y", 17 * heiScaleRatio)
                .style('font-weight', 300)
                .style("font-size", ".7rem")
                .style('font-family', 'noto-sans, sans-serif')
                .style('fill', 'rgba(255,255,255,0.8)')
                .text("average sentiment")
        }

        //time
        {
            const timeGroup = group.append("g")
                .attr("transform", `translate(480, 680)`);

            timeGroup
                .append("image")
                .attr("x", 0)
                .attr("y", 0 * heiScaleRatio)
                .attr("width", 24 * widScaleRatio)
                .attr("xlink:href", "img/time.svg");

            timeGroup
                .append('text')
                .attr("x", 40)
                .attr("y", 17 * heiScaleRatio)
                .style('font-weight', 300)
                .style("font-size", ".7rem")
                .style('font-family', 'noto-sans, sans-serif')
                .style('fill', 'rgba(255,255,255,0.8)')
                .text("create time & active time duration")
        }
    }

    //wind结果的group
    {
        const group = svg6.append("g")
            .attr("id", "windResGroup")
            .attr("opacity", 0)
            .attr("transform", "translate(0, -80)");

        group
            .append("image")
            .attr("x", 0)
            .attr("y", 80 * heiScaleRatio)
            .attr("opacity", 1)
            .attr("width", 800 * widScaleRatio)
            .attr("xlink:href", "img/windRes.png");

        group
            .append('text')
            .attr("x", 280)
            .attr("y", 180)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,255,255,0.8)')
            .text("active time duration")

        group
            .append('text')
            .attr("x", 180)
            .attr("y", 480)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,255,255,0.8)')
            .text("windline: hashtag groups")

        group
            .append('text')
            .attr("x", 300)
            .attr("y", 580)
            .style('font-weight', 300)
            .style("font-size", ".7rem")
            .style('font-family', 'hand')
            .style('fill', 'rgba(255,255,255,0.8)')
            .text("X-axis: timeline")

        {
            const inGroup = group.append("g")
                .attr("transform", "translate(-60, 20)");

            inGroup
                .append('text')
                .attr("x", 200)
                .attr("y", 640)
                .style('font-weight', 300)
                .style("font-size", ".7rem")
                .style('font-family', 'hand')
                .style('fill', 'rgba(255,255,255,0.8)')
                .text("wind_tail color:")

            inGroup
                .append('text')
                .attr("x", 200)
                .attr("y", 670)
                .style('font-weight', 300)
                .style("font-size", ".7rem")
                .style('font-family', 'hand')
                .style('fill', 'rgba(255,255,255,0.8)')
                .text(" average sentiment")

            inGroup
                .append('text')
                .attr("x", 200)
                .attr("y", 730)
                .style('font-weight', 300)
                .style("font-size", ".6rem")
                .style('font-family', 'noto-sans, sans-serif')
                .style('fill', 'rgba(255,255,255,0.8)')
                .text("negative")

            inGroup
                .append('text')
                .attr("x", 350)
                .attr("y", 730)
                .style('font-weight', 300)
                .style("font-size", ".6rem")
                .style('font-family', 'noto-sans, sans-serif')
                .style('fill', 'rgba(255,255,255,0.8)')
                .text("positive")

            inGroup
                .append("image")
                .attr("x", 200)
                .attr("y", 700 * heiScaleRatio)
                .attr("opacity", 1)
                .attr("width", 200 * widScaleRatio)
                .attr("xlink:href", "img/gradient.png");
        }

        {
            const inGroup = group.append("g")
                .attr("transform", "translate(200, 20)")
            inGroup
                .append('text')
                .attr("x", 200)
                .attr("y", 640)
                .style('font-weight', 300)
                .style("font-size", ".7rem")
                .style('font-family', 'hand')
                .style('fill', 'rgba(255,255,255,0.8)')
                .text("shape:")

            inGroup
                .append('text')
                .attr("x", 200)
                .attr("y", 670)
                .style('font-weight', 300)
                .style("font-size", ".7rem")
                .style('font-family', 'hand')
                .style('fill', 'rgba(255,255,255,0.8)')
                .text("no. of views, originals, discussions")

            inGroup
                .append("image")
                .attr("x", 200)
                .attr("y", 700 * heiScaleRatio)
                .attr("opacity", 1)
                .attr("width", 300 * widScaleRatio)
                .attr("xlink:href", "img/windShapes.png");
        }
    }

</script>

<!--scroll magic svg6-->
<script>
    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#windDataEnter",
        duration: document.getElementById('windDesignResExit').getBoundingClientRect().top - document.getElementById('windDataEnter').getBoundingClientRect().top + 100 * heiScaleRatio,
        offset: 10 * 24 * heiScaleRatio
    })
        .setPin("#divFixed6")
        // .addIndicators({name: "xxx (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#windDataExitExit",
        duration: 4 * 24 * heiScaleRatio,
        offset: -4 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#windAttrGroup")
                .attr("opacity", 1 - event.progress);

            d3.select("#windGroupSketch2")
                .attr("opacity", 1 - event.progress);
        })
        .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#windDesignResExit",
        duration: 4 * 24 * heiScaleRatio,
        offset: -12 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#windResGroup")
                .attr("opacity", event.progress);
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#windDataExit",
        duration: 4 * 24 * heiScaleRatio,
        offset: -8 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            const scale = d3.scaleLinear()
                .domain([0, 1])
                .range([windAttrGroupIndY1, windAttrGroupIndY2]);
            d3.select("#windAttrGroup")
                .attr("transform", `translate(${0}, ${scale(event.progress)})`);
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#windDataEnter",
        duration: 14 * 24 * heiScaleRatio,
        offset: 18 * 24 * heiScaleRatio
    })
        .setPin("#windDataFixed")
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);


    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#windDataEnter",
        duration: 4 * 24 * heiScaleRatio,
        offset: 18 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            const scale = d3.scaleLinear()
                .domain([0, 1])
                .range([1, 0.1]);
            d3.select("#windQRight")
                .attr("opacity", scale(event.progress))

            d3.select("#windGroupSketch1")
                .attr("opacity", event.progress)
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#windDataEnter",
        duration: 4 * 24 * heiScaleRatio,
        offset: 24 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            const scale = d3.scaleLinear()
                .domain([0, 1])
                .range([1, 0.1]);

            const scale2 = d3.scaleLinear()
                .domain([0, 1])
                .range([0.1, 1]);

            d3.select("#windGroupSketch1")
                .attr("opacity", 1 - event.progress)

            d3.select("#windGroupSketch2")
                .attr("opacity", event.progress)

            d3.select("#windQLeft")
                .attr("opacity", scale(event.progress))

            d3.select("#windQRight")
                .attr("opacity", scale2(event.progress))
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);


    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#windMapEnter",
        duration: 4 * 24 * heiScaleRatio,
        offset: -8 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#windMap")
                .attr("opacity", event.progress);
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#windMapExit",
        duration: 4 * 24 * heiScaleRatio,
        offset: 2 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#windMap")
                .attr("opacity", 1 - event.progress);
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#demenRedEnter",
        duration: 4 * 24 * heiScaleRatio,
        offset: -8 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#dimensionRedDiv")
                .style("opacity", event.progress);
        })
        // .addIndicators({name: "22 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#demenRedExit",
        duration: 4 * 24 * heiScaleRatio,
        offset: 2 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#dimensionRedDiv")
                .style("opacity", 1 - event.progress);
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#windSketchMapEnter",
        duration: 4 * 24 * heiScaleRatio,
        offset: -8 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#Attr3MapDiv")
                .style("opacity", event.progress);
        })
        // .addIndicators({name: "22 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#windSketchMapExit",
        duration: 4 * 24 * heiScaleRatio,
        offset: 2 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#Attr3MapDiv")
                .style("opacity", 1 - event.progress);
        })

        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#windSketchAttrsMapEnter",
        duration: 4 * 24 * heiScaleRatio,
        offset: -6 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#windSketchAttrsMap")
                .attr("opacity", event.progress);
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);

    var divStayedScene = new ScrollMagic.Scene({
        triggerElement: "#windSketchAttrsMapEnter",
        duration: 4 * 24 * heiScaleRatio,
        offset: 6 * 24 * heiScaleRatio
    })
        .on("progress", function (event) {
            d3.select("#windSketchAttrsMap")
                .attr("opacity", 1 - event.progress);
        })
        // .addIndicators({name: "1 (duration: windowHei)"}) // add indicators (requires plugin)
        .addTo(controller);


</script>


</body>
</html>